{
  "version": 3,
  "sources": ["../../frontend/state.ts", "../../frontend/websocket.ts", "../../frontend/utils.ts", "../../frontend/components.ts", "../../frontend/app.ts"],
  "sourcesContent": ["/**\n * Dashboard State Management\n */\n\nimport type { Agent, Message, AppState, ChannelType } from './types.js';\n\n/**\n * Global application state\n */\nexport const state: AppState = {\n  agents: [],\n  messages: [],\n  currentChannel: 'general',\n  currentThread: null,\n  isConnected: false,\n  ws: null,\n  reconnectAttempts: 0,\n};\n\n/**\n * State update callbacks\n */\ntype StateListener = () => void;\nconst listeners: StateListener[] = [];\n\n/**\n * Subscribe to state changes\n */\nexport function subscribe(listener: StateListener): () => void {\n  listeners.push(listener);\n  return () => {\n    const index = listeners.indexOf(listener);\n    if (index > -1) {\n      listeners.splice(index, 1);\n    }\n  };\n}\n\n/**\n * Notify all listeners of state change\n */\nfunction notifyListeners(): void {\n  listeners.forEach((listener) => listener());\n}\n\n/**\n * Update agents in state\n */\nexport function setAgents(agents: Agent[]): void {\n  state.agents = agents;\n  notifyListeners();\n}\n\n/**\n * Update messages in state\n */\nexport function setMessages(messages: Message[]): void {\n  state.messages = messages;\n  notifyListeners();\n}\n\n/**\n * Set current channel/conversation\n */\nexport function setCurrentChannel(channel: ChannelType): void {\n  state.currentChannel = channel;\n  notifyListeners();\n}\n\n/**\n * Update connection status\n */\nexport function setConnectionStatus(connected: boolean): void {\n  state.isConnected = connected;\n  if (connected) {\n    state.reconnectAttempts = 0;\n  }\n  notifyListeners();\n}\n\n/**\n * Increment reconnect attempts\n */\nexport function incrementReconnectAttempts(): void {\n  state.reconnectAttempts++;\n}\n\n/**\n * Set WebSocket instance\n */\nexport function setWebSocket(ws: WebSocket | null): void {\n  state.ws = ws;\n}\n\n/**\n * Filter messages based on current channel\n */\nexport function getFilteredMessages(): Message[] {\n  const { messages, currentChannel } = state;\n\n  if (currentChannel === 'general') {\n    return messages;\n  }\n\n  // Filter for specific agent - show messages to/from that agent\n  return messages.filter(\n    (m) => m.from === currentChannel || m.to === currentChannel\n  );\n}\n\n/**\n * Set current thread for thread panel\n */\nexport function setCurrentThread(thread: string | null): void {\n  state.currentThread = thread;\n}\n\n/**\n * Get messages for a specific thread\n */\nexport function getThreadMessages(threadId: string): Message[] {\n  return state.messages.filter((m) => m.thread === threadId);\n}\n\n/**\n * Get reply count for a thread\n */\nexport function getThreadReplyCount(threadId: string): number {\n  return state.messages.filter((m) => m.thread === threadId).length;\n}\n", "/**\n * WebSocket Connection Handler\n */\n\nimport type { DashboardData } from './types.js';\nimport {\n  state,\n  setAgents,\n  setMessages,\n  setConnectionStatus,\n  setWebSocket,\n  incrementReconnectAttempts,\n} from './state.js';\n\ntype DataHandler = (data: DashboardData) => void;\n\nlet dataHandler: DataHandler | null = null;\n\n/**\n * Set the handler for incoming data\n */\nexport function onData(handler: DataHandler): void {\n  dataHandler = handler;\n}\n\n/**\n * Connect to the WebSocket server\n */\nexport function connect(): void {\n  const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n  const ws = new WebSocket(`${protocol}//${window.location.host}/ws`);\n\n  ws.onopen = (): void => {\n    setConnectionStatus(true);\n  };\n\n  ws.onclose = (): void => {\n    setConnectionStatus(false);\n    // Reconnect with exponential backoff\n    const delay = Math.min(1000 * Math.pow(2, state.reconnectAttempts), 30000);\n    incrementReconnectAttempts();\n    setTimeout(connect, delay);\n  };\n\n  ws.onerror = (error): void => {\n    console.error('WebSocket error:', error);\n  };\n\n  ws.onmessage = (event: MessageEvent): void => {\n    try {\n      const data: DashboardData = JSON.parse(event.data as string);\n      handleData(data);\n    } catch (e) {\n      console.error('Failed to parse message:', e);\n    }\n  };\n\n  setWebSocket(ws);\n}\n\n/**\n * Handle incoming dashboard data\n */\nfunction handleData(data: DashboardData): void {\n  console.log('[WS] Received data:', { agentCount: data.agents?.length, messageCount: data.messages?.length });\n\n  if (data.agents) {\n    console.log('[WS] Setting agents:', data.agents.map(a => a.name));\n    setAgents(data.agents);\n  }\n\n  if (data.messages) {\n    setMessages(data.messages);\n  }\n\n  if (dataHandler) {\n    dataHandler(data);\n  }\n}\n\n/**\n * Send a message via the REST API\n */\nexport async function sendMessage(\n  to: string,\n  message: string,\n  thread?: string\n): Promise<{ success: boolean; error?: string }> {\n  try {\n    const body: { to: string; message: string; thread?: string } = { to, message };\n    if (thread) {\n      body.thread = thread;\n    }\n\n    const response = await fetch('/api/send', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(body),\n    });\n\n    const result = await response.json();\n\n    if (response.ok && result.success) {\n      return { success: true };\n    } else {\n      return { success: false, error: result.error || 'Failed to send message' };\n    }\n  } catch (err) {\n    return { success: false, error: 'Network error - could not send message' };\n  }\n}\n", "/**\n * Dashboard Utility Functions\n */\n\n/** Threshold for considering an agent offline (30 seconds) */\nexport const STALE_THRESHOLD_MS = 30000;\n\n/**\n * Check if an agent is online based on last seen timestamp\n */\nexport function isAgentOnline(lastSeen: string | undefined): boolean {\n  if (!lastSeen) return false;\n  const ts = Date.parse(lastSeen);\n  if (Number.isNaN(ts)) return false;\n  return Date.now() - ts < STALE_THRESHOLD_MS;\n}\n\n/**\n * Escape HTML to prevent XSS\n */\nexport function escapeHtml(text: string | undefined): string {\n  if (!text) return '';\n  const div = document.createElement('div');\n  div.textContent = text;\n  return div.innerHTML;\n}\n\n/**\n * Format timestamp to locale time string\n */\nexport function formatTime(timestamp: string): string {\n  const date = new Date(timestamp);\n  return date.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });\n}\n\n/**\n * Format timestamp to human-readable date\n */\nexport function formatDate(timestamp: string): string {\n  const date = new Date(timestamp);\n  const today = new Date();\n  const yesterday = new Date(today);\n  yesterday.setDate(yesterday.getDate() - 1);\n\n  if (date.toDateString() === today.toDateString()) {\n    return 'Today';\n  } else if (date.toDateString() === yesterday.toDateString()) {\n    return 'Yesterday';\n  } else {\n    return date.toLocaleDateString([], {\n      weekday: 'long',\n      month: 'long',\n      day: 'numeric',\n    });\n  }\n}\n\n/**\n * Generate a consistent color for an agent based on their name\n */\nexport function getAvatarColor(name: string): string {\n  const colors = [\n    '#e01e5a',\n    '#2bac76',\n    '#e8a427',\n    '#1264a3',\n    '#7c3aed',\n    '#0d9488',\n    '#dc2626',\n    '#9333ea',\n    '#ea580c',\n    '#0891b2',\n  ];\n  let hash = 0;\n  for (let i = 0; i < name.length; i++) {\n    hash = name.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  return colors[Math.abs(hash) % colors.length];\n}\n\n/**\n * Get initials from a name (first 2 characters, uppercase)\n */\nexport function getInitials(name: string): string {\n  return name.substring(0, 2).toUpperCase();\n}\n\n/**\n * Format message body with basic markdown-like formatting\n */\nexport function formatMessageBody(content: string | undefined): string {\n  if (!content) return '';\n\n  let escaped = escapeHtml(content);\n\n  // Simple code block detection\n  escaped = escaped.replace(/```([\\s\\S]*?)```/g, '<pre>$1</pre>');\n  escaped = escaped.replace(/`([^`]+)`/g, '<code>$1</code>');\n\n  // Convert newlines to <br> for proper multi-line display\n  escaped = escaped.replace(/\\n/g, '<br>');\n\n  return escaped;\n}\n", "/**\n * Dashboard UI Components\n */\n\nimport type { Agent, Message, DOMElements, ChannelType } from './types.js';\nimport { state, getFilteredMessages, setCurrentChannel, setCurrentThread, getThreadMessages, getThreadReplyCount } from './state.js';\nimport {\n  escapeHtml,\n  formatTime,\n  formatDate,\n  getAvatarColor,\n  getInitials,\n  formatMessageBody,\n  isAgentOnline,\n} from './utils.js';\n\nlet elements: DOMElements;\nlet paletteSelectedIndex = -1;\n\n/**\n * Initialize DOM element references\n */\nexport function initElements(): DOMElements {\n  elements = {\n    connectionDot: document.getElementById('connection-dot')!,\n    channelsList: document.getElementById('channels-list')!,\n    agentsList: document.getElementById('agents-list')!,\n    messagesList: document.getElementById('messages-list')!,\n    currentChannelName: document.getElementById('current-channel-name')!,\n    channelTopic: document.getElementById('channel-topic')!,\n    onlineCount: document.getElementById('online-count')!,\n    messageInput: document.getElementById('message-input') as HTMLTextAreaElement,\n    sendBtn: document.getElementById('send-btn') as HTMLButtonElement,\n    boldBtn: document.getElementById('bold-btn') as HTMLButtonElement,\n    emojiBtn: document.getElementById('emoji-btn') as HTMLButtonElement,\n    searchTrigger: document.getElementById('search-trigger')!,\n    commandPaletteOverlay: document.getElementById('command-palette-overlay')!,\n    paletteSearch: document.getElementById('palette-search') as HTMLInputElement,\n    paletteResults: document.getElementById('palette-results')!,\n    paletteChannelsSection: document.getElementById('palette-channels-section')!,\n    paletteAgentsSection: document.getElementById('palette-agents-section')!,\n    paletteMessagesSection: document.getElementById('palette-messages-section')!,\n    typingIndicator: document.getElementById('typing-indicator')!,\n    threadPanelOverlay: document.getElementById('thread-panel-overlay')!,\n    threadPanelId: document.getElementById('thread-panel-id')!,\n    threadPanelClose: document.getElementById('thread-panel-close') as HTMLButtonElement,\n    threadMessages: document.getElementById('thread-messages')!,\n    threadMessageInput: document.getElementById('thread-message-input') as HTMLTextAreaElement,\n    threadSendBtn: document.getElementById('thread-send-btn') as HTMLButtonElement,\n    mentionAutocomplete: document.getElementById('mention-autocomplete')!,\n    mentionAutocompleteList: document.getElementById('mention-autocomplete-list')!,\n  };\n  return elements;\n}\n\n/**\n * Get DOM elements\n */\nexport function getElements(): DOMElements {\n  return elements;\n}\n\n/**\n * Update connection status indicator\n */\nexport function updateConnectionStatus(): void {\n  if (state.isConnected) {\n    elements.connectionDot.classList.remove('offline');\n  } else {\n    elements.connectionDot.classList.add('offline');\n  }\n}\n\n/**\n * Render agents list in sidebar\n */\nexport function renderAgents(): void {\n  console.log('[UI] renderAgents called, agents:', state.agents.length, state.agents.map(a => a.name));\n  const html = state.agents\n    .map((agent) => {\n      const online = isAgentOnline(agent.lastSeen || agent.lastActive);\n      const presenceClass = online ? 'online' : '';\n      const isActive = state.currentChannel === agent.name;\n      const needsAttentionClass = agent.needsAttention ? 'needs-attention' : '';\n\n      return `\n      <li class=\"channel-item ${isActive ? 'active' : ''} ${needsAttentionClass}\" data-agent=\"${escapeHtml(agent.name)}\">\n        <div class=\"agent-avatar\" style=\"background: ${getAvatarColor(agent.name)}\">\n          ${getInitials(agent.name)}\n          <span class=\"presence-indicator ${presenceClass}\"></span>\n        </div>\n        <span class=\"channel-name\">${escapeHtml(agent.name)}</span>\n        ${agent.needsAttention ? '<span class=\"attention-badge\">Needs Input</span>' : ''}\n        <div class=\"agent-actions\">\n          <button class=\"agent-action-btn kill-btn agent-kill-btn\" data-agent=\"${escapeHtml(agent.name)}\" title=\"Kill agent\">\n            <svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/>\n              <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/>\n            </svg>\n          </button>\n        </div>\n      </li>\n    `;\n    })\n    .join('');\n\n  elements.agentsList.innerHTML =\n    html ||\n    '<li class=\"channel-item\" style=\"color: var(--text-muted); cursor: default;\">No agents connected</li>';\n\n  // Add click handlers\n  elements.agentsList.querySelectorAll<HTMLElement>('.channel-item[data-agent]').forEach((item) => {\n    item.addEventListener('click', (e) => {\n      // Don't navigate if clicking on action buttons\n      if ((e.target as HTMLElement).closest('.agent-actions')) {\n        return;\n      }\n      const agentName = item.dataset.agent;\n      if (agentName) {\n        selectChannel(agentName);\n      }\n    });\n  });\n\n  // Update command palette agents\n  updatePaletteAgents();\n\n  // Attach kill handlers (dynamically imported to avoid circular dependency)\n  import('./app.js').then(({ attachKillHandlers }) => {\n    attachKillHandlers();\n  }).catch(() => {\n    // Ignore if app.js not yet ready\n  });\n}\n\n/**\n * Render messages list\n */\nexport function renderMessages(): void {\n  const filtered = getFilteredMessages();\n\n  if (filtered.length === 0) {\n    elements.messagesList.innerHTML = `\n      <div class=\"empty-state\">\n        <svg class=\"empty-state-icon\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\">\n          <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n        </svg>\n        <div class=\"empty-state-title\">No messages yet</div>\n        <div class=\"empty-state-text\">\n          ${\n            state.currentChannel === 'general'\n              ? 'Messages between agents will appear here'\n              : `Messages with ${state.currentChannel} will appear here`\n          }\n        </div>\n      </div>\n    `;\n    return;\n  }\n\n  let html = '';\n  let lastDate: string | null = null;\n\n  filtered.forEach((msg) => {\n    const msgDate = new Date(msg.timestamp).toDateString();\n\n    // Add date divider if needed\n    if (msgDate !== lastDate) {\n      html += `\n        <div class=\"date-divider\">\n          <span class=\"date-divider-text\">${formatDate(msg.timestamp)}</span>\n        </div>\n      `;\n      lastDate = msgDate;\n    }\n\n    const isBroadcast = msg.to === '*';\n    const avatarColor = getAvatarColor(msg.from);\n    const replyCount = getThreadReplyCount(msg.id);\n\n    // Format: @From \u2192 @To: message (like Slack)\n    // For cross-project messages, show project badge before agent name\n    const recipientDisplay = isBroadcast\n      ? '@everyone'\n      : msg.project\n        ? `<span class=\"project-badge\">${escapeHtml(msg.project)}</span>@${escapeHtml(msg.to)}`\n        : `@${escapeHtml(msg.to)}`;\n\n    html += `\n      <div class=\"message ${isBroadcast ? 'broadcast' : ''}\" data-id=\"${escapeHtml(msg.id)}\">\n        <div class=\"message-avatar\" style=\"background: ${avatarColor}\">\n          ${getInitials(msg.from)}\n        </div>\n        <div class=\"message-content\">\n          <div class=\"message-header\">\n            <span class=\"message-sender\">@${escapeHtml(msg.from)}</span>\n            <span class=\"message-recipient\">\n              \u2192 <span class=\"target\">${recipientDisplay}</span>\n            </span>\n            <span class=\"message-timestamp\">${formatTime(msg.timestamp)}</span>\n          </div>\n          <div class=\"message-body\">${formatMessageBody(msg.content)}</div>\n          ${\n            msg.thread\n              ? `\n            <div class=\"thread-indicator\" data-thread=\"${escapeHtml(msg.thread)}\">\n              <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n              </svg>\n              Thread: ${escapeHtml(msg.thread)}\n            </div>\n          `\n              : ''\n          }\n          ${\n            replyCount > 0\n              ? `\n            <div class=\"reply-count-badge\" data-thread=\"${escapeHtml(msg.id)}\">\n              <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n              </svg>\n              ${replyCount} ${replyCount === 1 ? 'reply' : 'replies'}\n            </div>\n          `\n              : ''\n          }\n        </div>\n        <div class=\"message-actions\">\n          <button class=\"message-action-btn\" data-action=\"reply\" title=\"Reply in thread\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n            </svg>\n          </button>\n          <button class=\"message-action-btn\" title=\"Add reaction\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <circle cx=\"12\" cy=\"12\" r=\"10\"/>\n              <path d=\"M8 14s1.5 2 4 2 4-2 4-2\"/>\n              <line x1=\"9\" y1=\"9\" x2=\"9.01\" y2=\"9\"/>\n              <line x1=\"15\" y1=\"9\" x2=\"15.01\" y2=\"9\"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n    `;\n  });\n\n  elements.messagesList.innerHTML = html;\n\n  // Note: Auto-scroll removed - interferes with manual scrolling through history\n\n  // Attach thread click handlers\n  attachThreadHandlers();\n}\n\n/**\n * Select a channel and update UI\n */\nexport function selectChannel(channel: ChannelType): void {\n  setCurrentChannel(channel);\n\n  // Update sidebar active states\n  elements.channelsList.querySelectorAll<HTMLElement>('.channel-item').forEach((item) => {\n    item.classList.toggle('active', item.dataset.channel === channel);\n  });\n  elements.agentsList.querySelectorAll<HTMLElement>('.channel-item').forEach((item) => {\n    item.classList.toggle('active', item.dataset.agent === channel);\n  });\n\n  // Update header\n  const prefixEl = document.querySelector('.channel-header-name .prefix');\n  if (channel === 'general') {\n    elements.currentChannelName.innerHTML = 'general';\n    elements.channelTopic.textContent = 'All agent communications';\n    if (prefixEl) prefixEl.textContent = '#';\n  } else {\n    elements.currentChannelName.innerHTML = escapeHtml(channel);\n    const agent = state.agents.find((a) => a.name === channel);\n    elements.channelTopic.textContent = agent?.status || 'Direct messages';\n    if (prefixEl) prefixEl.textContent = '@';\n  }\n\n  // Update composer placeholder with @mention format\n  elements.messageInput.placeholder =\n    channel === 'general'\n      ? '@AgentName message... (or @* to broadcast)'\n      : `@${channel} your message here...`;\n\n  // Re-render messages\n  renderMessages();\n}\n\n/**\n * Update online count display\n */\nexport function updateOnlineCount(): void {\n  const online = state.agents.filter((a) => isAgentOnline(a.lastSeen || a.lastActive)).length;\n  elements.onlineCount.textContent = `${online} online`;\n}\n\n/**\n * Update agents in command palette\n */\nexport function updatePaletteAgents(): void {\n  const html = state.agents\n    .map((agent) => {\n      const online = isAgentOnline(agent.lastSeen || agent.lastActive);\n      return `\n      <div class=\"palette-item\" data-jump-agent=\"${escapeHtml(agent.name)}\">\n        <div class=\"palette-item-icon\">\n          <div class=\"agent-avatar\" style=\"background: ${getAvatarColor(agent.name)}; width: 20px; height: 20px; font-size: 9px;\">\n            ${getInitials(agent.name)}\n            <span class=\"presence-indicator ${online ? 'online' : ''}\"></span>\n          </div>\n        </div>\n        <div class=\"palette-item-content\">\n          <div class=\"palette-item-title\">${escapeHtml(agent.name)}</div>\n          <div class=\"palette-item-subtitle\">${online ? 'Online' : 'Offline'}</div>\n        </div>\n      </div>\n    `;\n    })\n    .join('');\n\n  const section = elements.paletteAgentsSection;\n  const items = section.querySelectorAll('.palette-item');\n  items.forEach((item) => item.remove());\n  section.insertAdjacentHTML('beforeend', html);\n\n  // Add click handlers\n  section.querySelectorAll<HTMLElement>('.palette-item[data-jump-agent]').forEach((item) => {\n    item.addEventListener('click', () => {\n      const agentName = item.dataset.jumpAgent;\n      if (agentName) {\n        selectChannel(agentName);\n        closeCommandPalette();\n      }\n    });\n  });\n}\n\n/**\n * Initialize channel click handlers in command palette\n */\nexport function initPaletteChannels(): void {\n  elements.paletteChannelsSection\n    .querySelectorAll<HTMLElement>('.palette-item[data-jump-channel]')\n    .forEach((item) => {\n      item.addEventListener('click', () => {\n        const channelName = item.dataset.jumpChannel;\n        if (channelName) {\n          selectChannel(channelName);\n          closeCommandPalette();\n        }\n      });\n    });\n}\n\n/**\n * Open command palette\n */\nexport function openCommandPalette(): void {\n  elements.commandPaletteOverlay.classList.add('visible');\n  elements.paletteSearch.value = '';\n  elements.paletteSearch.focus();\n  paletteSelectedIndex = -1;\n  filterPaletteResults('');\n}\n\n/**\n * Get all visible palette items\n */\nexport function getVisiblePaletteItems(): HTMLElement[] {\n  const allItems = Array.from(\n    elements.paletteResults.querySelectorAll<HTMLElement>('.palette-item')\n  );\n  return allItems.filter((item) => item.style.display !== 'none');\n}\n\n/**\n * Update the selected palette item visually\n */\nexport function updatePaletteSelection(): void {\n  const items = getVisiblePaletteItems();\n\n  // Remove selection from all items\n  items.forEach((item) => item.classList.remove('selected'));\n\n  // Add selection to current item\n  if (paletteSelectedIndex >= 0 && paletteSelectedIndex < items.length) {\n    const selectedItem = items[paletteSelectedIndex];\n    selectedItem.classList.add('selected');\n\n    // Scroll into view if needed\n    selectedItem.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n  }\n}\n\n/**\n * Handle keyboard navigation in command palette\n */\nexport function handlePaletteKeydown(e: KeyboardEvent): void {\n  const items = getVisiblePaletteItems();\n\n  if (items.length === 0) return;\n\n  switch (e.key) {\n    case 'ArrowDown':\n      e.preventDefault();\n      paletteSelectedIndex = paletteSelectedIndex < items.length - 1\n        ? paletteSelectedIndex + 1\n        : 0;\n      updatePaletteSelection();\n      break;\n\n    case 'ArrowUp':\n      e.preventDefault();\n      paletteSelectedIndex = paletteSelectedIndex > 0\n        ? paletteSelectedIndex - 1\n        : items.length - 1;\n      updatePaletteSelection();\n      break;\n\n    case 'Enter':\n      e.preventDefault();\n      if (paletteSelectedIndex >= 0 && paletteSelectedIndex < items.length) {\n        executePaletteItem(items[paletteSelectedIndex]);\n      }\n      break;\n  }\n}\n\n/**\n * Execute the action for a palette item\n */\nexport function executePaletteItem(item: HTMLElement): void {\n  // Check for command\n  const command = item.dataset.command;\n  if (command) {\n    if (command === 'broadcast') {\n      // Pre-fill message input with @* for broadcast\n      elements.messageInput.value = '@* ';\n      elements.messageInput.focus();\n    } else if (command === 'clear') {\n      elements.messagesList.innerHTML = '';\n    }\n    closeCommandPalette();\n    return;\n  }\n\n  // Check for channel jump\n  const channel = item.dataset.jumpChannel;\n  if (channel) {\n    selectChannel(channel);\n    closeCommandPalette();\n    return;\n  }\n\n  // Check for agent jump\n  const agent = item.dataset.jumpAgent;\n  if (agent) {\n    selectChannel(agent);\n    closeCommandPalette();\n    return;\n  }\n\n  // Check for message jump\n  const messageId = item.dataset.jumpMessage;\n  if (messageId) {\n    // Find and scroll to the message\n    const messageEl = elements.messagesList.querySelector(`[data-id=\"${messageId}\"]`);\n    if (messageEl) {\n      messageEl.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      messageEl.classList.add('highlighted');\n      setTimeout(() => messageEl.classList.remove('highlighted'), 2000);\n    }\n    closeCommandPalette();\n    return;\n  }\n}\n\n/**\n * Close command palette\n */\nexport function closeCommandPalette(): void {\n  elements.commandPaletteOverlay.classList.remove('visible');\n}\n\n/**\n * Filter command palette results based on query\n */\nexport function filterPaletteResults(query: string): void {\n  const q = query.toLowerCase();\n\n  // Reset selection when filtering\n  paletteSelectedIndex = -1;\n\n  // Filter command items\n  document.querySelectorAll<HTMLElement>('.palette-item[data-command]').forEach((item) => {\n    const titleEl = item.querySelector('.palette-item-title');\n    const title = titleEl?.textContent?.toLowerCase() || '';\n    item.style.display = title.includes(q) ? 'flex' : 'none';\n  });\n\n  // Filter channel items\n  document.querySelectorAll<HTMLElement>('.palette-item[data-jump-channel]').forEach((item) => {\n    const titleEl = item.querySelector('.palette-item-title');\n    const title = titleEl?.textContent?.toLowerCase() || '';\n    item.style.display = title.includes(q) ? 'flex' : 'none';\n  });\n\n  // Filter agent items\n  document.querySelectorAll<HTMLElement>('.palette-item[data-jump-agent]').forEach((item) => {\n    const name = item.dataset.jumpAgent?.toLowerCase() || '';\n    item.style.display = name.includes(q) ? 'flex' : 'none';\n  });\n\n  // Show message search if query is long enough\n  if (q.length >= 2) {\n    const matches = state.messages.filter((m) => m.content.toLowerCase().includes(q)).slice(0, 5);\n\n    if (matches.length > 0) {\n      elements.paletteMessagesSection.style.display = 'block';\n      const items = matches\n        .map(\n          (m) => `\n        <div class=\"palette-item\" data-jump-message=\"${escapeHtml(m.id)}\">\n          <div class=\"palette-item-icon\">\n            <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n              <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n            </svg>\n          </div>\n          <div class=\"palette-item-content\">\n            <div class=\"palette-item-title\">${escapeHtml(m.from)}</div>\n            <div class=\"palette-item-subtitle\">${escapeHtml(m.content.substring(0, 60))}${m.content.length > 60 ? '...' : ''}</div>\n          </div>\n        </div>\n      `\n        )\n        .join('');\n\n      const existingItems = elements.paletteMessagesSection.querySelectorAll('.palette-item');\n      existingItems.forEach((item) => item.remove());\n      elements.paletteMessagesSection.insertAdjacentHTML('beforeend', items);\n    } else {\n      elements.paletteMessagesSection.style.display = 'none';\n    }\n  } else {\n    elements.paletteMessagesSection.style.display = 'none';\n  }\n}\n\n/**\n * Open thread panel for a specific thread\n */\nexport function openThreadPanel(threadId: string): void {\n  setCurrentThread(threadId);\n  elements.threadPanelId.textContent = threadId;\n  elements.threadPanelOverlay.classList.add('visible');\n  elements.threadMessageInput.value = '';\n  renderThreadMessages(threadId);\n  elements.threadMessageInput.focus();\n}\n\n/**\n * Close thread panel\n */\nexport function closeThreadPanel(): void {\n  setCurrentThread(null);\n  elements.threadPanelOverlay.classList.remove('visible');\n}\n\n/**\n * Render messages in thread panel\n */\nexport function renderThreadMessages(threadId: string): void {\n  const messages = getThreadMessages(threadId);\n\n  if (messages.length === 0) {\n    elements.threadMessages.innerHTML = `\n      <div class=\"thread-empty\">\n        <p>No messages in this thread yet.</p>\n        <p style=\"font-size: 12px; margin-top: 8px;\">Start the conversation below!</p>\n      </div>\n    `;\n    return;\n  }\n\n  const html = messages\n    .map((msg) => `\n      <div class=\"thread-message\">\n        <div class=\"thread-message-header\">\n          <div class=\"thread-message-avatar\" style=\"background: ${getAvatarColor(msg.from)}\">\n            ${getInitials(msg.from)}\n          </div>\n          <span class=\"thread-message-sender\">${escapeHtml(msg.from)}</span>\n          <span class=\"thread-message-time\">${formatTime(msg.timestamp)}</span>\n        </div>\n        <div class=\"thread-message-body\">${formatMessageBody(msg.content)}</div>\n      </div>\n    `)\n    .join('');\n\n  elements.threadMessages.innerHTML = html;\n\n  // Scroll to bottom\n  elements.threadMessages.scrollTop = elements.threadMessages.scrollHeight;\n}\n\n/**\n * Attach thread click handlers to messages (call after renderMessages)\n */\nexport function attachThreadHandlers(): void {\n  // Thread indicator clicks\n  elements.messagesList.querySelectorAll<HTMLElement>('.thread-indicator').forEach((el) => {\n    el.style.cursor = 'pointer';\n    el.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const threadId = el.dataset.thread;\n      if (threadId) {\n        openThreadPanel(threadId);\n      }\n    });\n  });\n\n  // Reply count badge clicks\n  elements.messagesList.querySelectorAll<HTMLElement>('.reply-count-badge').forEach((el) => {\n    el.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const threadId = el.dataset.thread;\n      if (threadId) {\n        openThreadPanel(threadId);\n      }\n    });\n  });\n\n  // Reply in thread button clicks\n  elements.messagesList.querySelectorAll<HTMLElement>('.message-action-btn[data-action=\"reply\"]').forEach((el) => {\n    el.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const messageId = el.closest('.message')?.getAttribute('data-id');\n      if (messageId) {\n        // Use message ID as thread ID for new threads\n        openThreadPanel(messageId);\n      }\n    });\n  });\n}\n\n/**\n * @-Mention Autocomplete State\n */\nlet mentionSelectedIndex = 0;\nlet mentionFilteredAgents: typeof state.agents = [];\n\n/**\n * Show mention autocomplete dropdown with filtered agents\n */\nexport function showMentionAutocomplete(filter: string): void {\n  const filterLower = filter.toLowerCase();\n\n  // Filter agents by name, include broadcast option\n  mentionFilteredAgents = state.agents.filter(agent =>\n    agent.name.toLowerCase().includes(filterLower)\n  );\n\n  // Reset selection\n  mentionSelectedIndex = 0;\n\n  // Build HTML for agent list\n  let html = '';\n\n  // Add broadcast option if filter matches\n  if ('*'.includes(filterLower) || 'everyone'.includes(filterLower) || 'all'.includes(filterLower) || 'broadcast'.includes(filterLower)) {\n    html += `\n      <div class=\"mention-autocomplete-item ${mentionSelectedIndex === 0 && mentionFilteredAgents.length === 0 ? 'selected' : ''}\" data-mention=\"*\">\n        <div class=\"agent-avatar\" style=\"background: var(--accent-yellow);\">*</div>\n        <span class=\"mention-autocomplete-name\">@everyone</span>\n        <span class=\"mention-autocomplete-role\">Broadcast to all</span>\n      </div>\n    `;\n  }\n\n  // Add agents\n  mentionFilteredAgents.forEach((agent, index) => {\n    const isSelected = index === mentionSelectedIndex;\n    html += `\n      <div class=\"mention-autocomplete-item ${isSelected ? 'selected' : ''}\" data-mention=\"${escapeHtml(agent.name)}\">\n        <div class=\"agent-avatar\" style=\"background: ${getAvatarColor(agent.name)}\">\n          ${getInitials(agent.name)}\n        </div>\n        <span class=\"mention-autocomplete-name\">@${escapeHtml(agent.name)}</span>\n        <span class=\"mention-autocomplete-role\">${escapeHtml(agent.role || 'Agent')}</span>\n      </div>\n    `;\n  });\n\n  if (html === '') {\n    html = '<div class=\"mention-autocomplete-item\" style=\"color: var(--text-muted); cursor: default;\">No matching agents</div>';\n  }\n\n  elements.mentionAutocompleteList.innerHTML = html;\n  elements.mentionAutocomplete.classList.add('visible');\n\n  // Add click handlers to items\n  elements.mentionAutocompleteList.querySelectorAll<HTMLElement>('.mention-autocomplete-item[data-mention]').forEach((item) => {\n    item.addEventListener('click', () => {\n      const mention = item.dataset.mention;\n      if (mention) {\n        completeMention(mention);\n      }\n    });\n  });\n}\n\n/**\n * Hide mention autocomplete dropdown\n */\nexport function hideMentionAutocomplete(): void {\n  elements.mentionAutocomplete.classList.remove('visible');\n  mentionFilteredAgents = [];\n  mentionSelectedIndex = 0;\n}\n\n/**\n * Check if mention autocomplete is visible\n */\nexport function isMentionAutocompleteVisible(): boolean {\n  return elements.mentionAutocomplete.classList.contains('visible');\n}\n\n/**\n * Navigate mention autocomplete selection\n */\nexport function navigateMentionAutocomplete(direction: 'up' | 'down'): void {\n  const items = elements.mentionAutocompleteList.querySelectorAll<HTMLElement>('.mention-autocomplete-item[data-mention]');\n  if (items.length === 0) return;\n\n  // Remove current selection\n  items[mentionSelectedIndex]?.classList.remove('selected');\n\n  // Update index\n  if (direction === 'down') {\n    mentionSelectedIndex = (mentionSelectedIndex + 1) % items.length;\n  } else {\n    mentionSelectedIndex = (mentionSelectedIndex - 1 + items.length) % items.length;\n  }\n\n  // Add new selection\n  items[mentionSelectedIndex]?.classList.add('selected');\n  items[mentionSelectedIndex]?.scrollIntoView({ block: 'nearest' });\n}\n\n/**\n * Complete the current mention selection\n */\nexport function completeMention(mention?: string): void {\n  const items = elements.mentionAutocompleteList.querySelectorAll<HTMLElement>('.mention-autocomplete-item[data-mention]');\n\n  // Use provided mention or get from selected item\n  let selectedMention = mention;\n  if (!selectedMention && items.length > 0) {\n    selectedMention = items[mentionSelectedIndex]?.dataset.mention;\n  }\n\n  if (!selectedMention) {\n    hideMentionAutocomplete();\n    return;\n  }\n\n  // Replace the @... text with the completed mention\n  const input = elements.messageInput;\n  const value = input.value;\n\n  // Find the @ position (should be at start or after whitespace)\n  const atMatch = value.match(/^@\\S*/);\n  if (atMatch) {\n    // Replace the @partial with @CompletedName\n    const completedText = `@${selectedMention} `;\n    input.value = completedText + value.substring(atMatch[0].length);\n    input.selectionStart = input.selectionEnd = completedText.length;\n  }\n\n  hideMentionAutocomplete();\n  input.focus();\n}\n\n/**\n * Get the current @mention being typed (if any)\n */\nexport function getCurrentMentionQuery(): string | null {\n  const input = elements.messageInput;\n  const value = input.value;\n  const cursorPos = input.selectionStart;\n\n  // Check if cursor is within an @mention at the start\n  const atMatch = value.match(/^@(\\S*)/);\n  if (atMatch && cursorPos <= atMatch[0].length) {\n    return atMatch[1]; // Return the text after @\n  }\n\n  return null;\n}\n", "/**\n * Dashboard Application Entry Point\n */\n\nimport { subscribe } from './state.js';\nimport { connect, sendMessage } from './websocket.js';\nimport {\n  initElements,\n  getElements,\n  updateConnectionStatus,\n  renderAgents,\n  renderMessages,\n  selectChannel,\n  updateOnlineCount,\n  openCommandPalette,\n  closeCommandPalette,\n  filterPaletteResults,\n  handlePaletteKeydown,\n  initPaletteChannels,\n  closeThreadPanel,\n  renderThreadMessages,\n  showMentionAutocomplete,\n  hideMentionAutocomplete,\n  isMentionAutocompleteVisible,\n  navigateMentionAutocomplete,\n  completeMention,\n  getCurrentMentionQuery,\n} from './components.js';\nimport { state } from './state.js';\n\n/**\n * Detect if we're viewing a project dashboard from bridge context\n */\nfunction detectProjectContext(): { projectId: string | null; fromBridge: boolean } {\n  const pathname = window.location.pathname;\n  const match = pathname.match(/^\\/project\\/([^/]+)$/);\n\n  if (match) {\n    return { projectId: decodeURIComponent(match[1]), fromBridge: true };\n  }\n\n  return { projectId: null, fromBridge: false };\n}\n\n/**\n * Update the UI for project context (when accessed from bridge)\n */\nasync function setupProjectContext(projectId: string): Promise<void> {\n  // Update workspace name to show project\n  const workspaceName = document.querySelector('.workspace-name');\n  if (workspaceName) {\n    // Fetch project info\n    try {\n      const response = await fetch(`/api/project/${encodeURIComponent(projectId)}`);\n      if (response.ok) {\n        const project = await response.json();\n        const nameSpan = workspaceName.querySelector(':not(.status-dot)');\n        if (nameSpan && nameSpan.nodeType === Node.TEXT_NODE) {\n          nameSpan.textContent = project.name || projectId;\n        } else {\n          // Replace text content after status-dot\n          const textNodes = Array.from(workspaceName.childNodes).filter(n => n.nodeType === Node.TEXT_NODE);\n          textNodes.forEach(n => n.textContent = '');\n          workspaceName.appendChild(document.createTextNode(' ' + (project.name || projectId)));\n        }\n      }\n    } catch {\n      // Fallback - just show project ID\n    }\n  }\n\n  // Update bridge nav link to show \"Back to Bridge\" with back arrow\n  const bridgeLinkText = document.getElementById('bridge-link-text');\n  const bridgeNavLink = document.getElementById('bridge-nav-link');\n  if (bridgeLinkText) {\n    bridgeLinkText.textContent = '\u2190 Back to Bridge';\n  }\n  if (bridgeNavLink) {\n    bridgeNavLink.classList.add('back-to-bridge');\n  }\n\n  // Add a subtle indicator that we're in project view\n  document.body.classList.add('project-view');\n}\n\n/**\n * Initialize the dashboard application\n */\nexport function initApp(): void {\n  const elements = initElements();\n\n  // Check if we're in project context (from bridge)\n  const { projectId, fromBridge } = detectProjectContext();\n  if (fromBridge && projectId) {\n    setupProjectContext(projectId);\n  }\n\n  // Subscribe to state changes\n  subscribe(() => {\n    updateConnectionStatus();\n    renderAgents();\n    renderMessages();\n    updateOnlineCount();\n  });\n\n  // Set up event listeners\n  setupEventListeners(elements);\n\n  // Connect to WebSocket\n  connect();\n}\n\n/**\n * Set up all event listeners\n */\nfunction setupEventListeners(elements: ReturnType<typeof getElements>): void {\n  // Channel clicks\n  elements.channelsList.querySelectorAll<HTMLElement>('.channel-item').forEach((item) => {\n    item.addEventListener('click', () => {\n      const channel = item.dataset.channel;\n      if (channel) {\n        selectChannel(channel);\n      }\n    });\n  });\n\n  // Send button\n  elements.sendBtn.addEventListener('click', handleSend);\n\n  // Keyboard shortcuts for composer\n  elements.messageInput.addEventListener('keydown', (e: KeyboardEvent) => {\n    // Handle mention autocomplete keys first\n    if (isMentionAutocompleteVisible()) {\n      if (e.key === 'Tab' || e.key === 'Enter') {\n        e.preventDefault();\n        completeMention();\n        return;\n      }\n      if (e.key === 'ArrowUp') {\n        e.preventDefault();\n        navigateMentionAutocomplete('up');\n        return;\n      }\n      if (e.key === 'ArrowDown') {\n        e.preventDefault();\n        navigateMentionAutocomplete('down');\n        return;\n      }\n      if (e.key === 'Escape') {\n        e.preventDefault();\n        hideMentionAutocomplete();\n        return;\n      }\n    }\n\n    // Enter to send (Slack-style), Shift+Enter for newline\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n    // Shift+Enter allows default behavior (inserts newline)\n  });\n\n  // Auto-resize textarea and handle @-mention autocomplete\n  elements.messageInput.addEventListener('input', () => {\n    elements.messageInput.style.height = 'auto';\n    elements.messageInput.style.height =\n      Math.min(elements.messageInput.scrollHeight, 200) + 'px';\n\n    // Check for @-mention at start of input\n    const query = getCurrentMentionQuery();\n    if (query !== null) {\n      showMentionAutocomplete(query);\n    } else {\n      hideMentionAutocomplete();\n    }\n  });\n\n  // Hide mention autocomplete when input loses focus (with delay to allow clicks)\n  elements.messageInput.addEventListener('blur', () => {\n    setTimeout(() => {\n      hideMentionAutocomplete();\n    }, 150);\n  });\n\n  // Bold button - wrap selected text with ** or insert **bold**\n  elements.boldBtn.addEventListener('click', () => {\n    const input = elements.messageInput;\n    const start = input.selectionStart;\n    const end = input.selectionEnd;\n    const text = input.value;\n\n    if (start === end) {\n      // No selection - insert **bold** placeholder\n      const before = text.substring(0, start);\n      const after = text.substring(end);\n      input.value = before + '**bold**' + after;\n      input.selectionStart = start + 2;\n      input.selectionEnd = start + 6;\n    } else {\n      // Wrap selection with **\n      const before = text.substring(0, start);\n      const selected = text.substring(start, end);\n      const after = text.substring(end);\n      input.value = before + '**' + selected + '**' + after;\n      input.selectionStart = start;\n      input.selectionEnd = end + 4;\n    }\n    input.focus();\n  });\n\n  // Emoji button - insert common emojis via simple picker\n  elements.emojiBtn.addEventListener('click', () => {\n    const emojis = ['\uD83D\uDC4D', '\uD83D\uDC4E', '\u2705', '\u274C', '\uD83C\uDF89', '\uD83D\uDD25', '\uD83D\uDCA1', '\u26A0\uFE0F', '\uD83D\uDCDD', '\uD83D\uDE80'];\n    const emoji = emojis[Math.floor(Math.random() * emojis.length)];\n    const input = elements.messageInput;\n    const start = input.selectionStart;\n    const text = input.value;\n    input.value = text.substring(0, start) + emoji + text.substring(start);\n    input.selectionStart = input.selectionEnd = start + emoji.length;\n    input.focus();\n  });\n\n  // Command palette\n  elements.searchTrigger.addEventListener('click', openCommandPalette);\n\n  document.addEventListener('keydown', (e: KeyboardEvent) => {\n    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {\n      e.preventDefault();\n      if (elements.commandPaletteOverlay.classList.contains('visible')) {\n        closeCommandPalette();\n      } else {\n        openCommandPalette();\n      }\n    }\n\n    if (e.key === 'Escape') {\n      closeCommandPalette();\n    }\n  });\n\n  elements.commandPaletteOverlay.addEventListener('click', (e: MouseEvent) => {\n    if (e.target === elements.commandPaletteOverlay) {\n      closeCommandPalette();\n    }\n  });\n\n  elements.paletteSearch.addEventListener('input', (e: Event) => {\n    const target = e.target as HTMLInputElement;\n    filterPaletteResults(target.value);\n  });\n\n  elements.paletteSearch.addEventListener('keydown', handlePaletteKeydown);\n\n  // Command execution\n  document.querySelectorAll<HTMLElement>('.palette-item[data-command]').forEach((item) => {\n    item.addEventListener('click', () => {\n      const command = item.dataset.command;\n\n      if (command === 'bridge') {\n        // Navigate to bridge view\n        window.location.href = '/bridge';\n      } else if (command === 'broadcast') {\n        // Pre-fill message input with @* for broadcast\n        elements.messageInput.value = '@* ';\n        elements.messageInput.focus();\n      } else if (command === 'clear') {\n        elements.messagesList.innerHTML = '';\n      }\n\n      closeCommandPalette();\n    });\n  });\n\n  // Add Cmd/Ctrl+B shortcut for bridge navigation\n  document.addEventListener('keydown', (e: KeyboardEvent) => {\n    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {\n      e.preventDefault();\n      window.location.href = '/bridge';\n    }\n  });\n\n  // Initialize palette channel click handlers\n  initPaletteChannels();\n\n  // Thread panel close button\n  elements.threadPanelClose.addEventListener('click', closeThreadPanel);\n\n  // Thread panel send button\n  elements.threadSendBtn.addEventListener('click', handleThreadSend);\n\n  // Thread message input keyboard shortcuts (Slack-style)\n  elements.threadMessageInput.addEventListener('keydown', (e: KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleThreadSend();\n    }\n    // Shift+Enter allows default behavior (inserts newline)\n  });\n\n  // Close thread panel on Escape\n  document.addEventListener('keydown', (e: KeyboardEvent) => {\n    if (e.key === 'Escape' && elements.threadPanelOverlay.classList.contains('visible')) {\n      closeThreadPanel();\n    }\n  });\n}\n\n/**\n * Parse @mention from message text\n * Formats: \"@AgentName message\" or \"@* message\" for broadcast\n * Returns { to, message } or null if no valid mention found\n */\nfunction parseMention(text: string): { to: string; message: string } | null {\n  const trimmed = text.trim();\n\n  // Match @mention at the start of the message\n  // @* for broadcast, @AgentName for direct message\n  const match = trimmed.match(/^@(\\*|[^\\s]+)\\s+(.+)$/s);\n\n  if (!match) {\n    return null;\n  }\n\n  return {\n    to: match[1],\n    message: match[2].trim(),\n  };\n}\n\n/**\n * Handle send button click\n */\nasync function handleSend(): Promise<void> {\n  const elements = getElements();\n  const rawMessage = elements.messageInput.value.trim();\n\n  if (!rawMessage) {\n    return;\n  }\n\n  // Parse @mention from the message\n  const parsed = parseMention(rawMessage);\n\n  if (!parsed) {\n    alert('Message must start with @recipient (e.g., \"@Lead hello\" or \"@* broadcast\")');\n    return;\n  }\n\n  const { to, message } = parsed;\n\n  elements.sendBtn.disabled = true;\n\n  const result = await sendMessage(to, message);\n\n  if (result.success) {\n    elements.messageInput.value = '';\n    elements.messageInput.style.height = 'auto';\n  } else {\n    alert(result.error);\n  }\n\n  elements.sendBtn.disabled = false;\n}\n\n/**\n * Handle thread panel send button click\n */\nasync function handleThreadSend(): Promise<void> {\n  const elements = getElements();\n  const message = elements.threadMessageInput.value.trim();\n  const threadId = state.currentThread;\n\n  if (!message || !threadId) {\n    return;\n  }\n\n  // For thread replies, send to broadcast or use original recipient\n  // For now, send as broadcast with thread ID\n  elements.threadSendBtn.disabled = true;\n\n  const result = await sendMessage('*', message, threadId);\n\n  if (result.success) {\n    elements.threadMessageInput.value = '';\n    // Re-render thread messages to show the new message\n    renderThreadMessages(threadId);\n  } else {\n    alert(result.error);\n  }\n\n  elements.threadSendBtn.disabled = false;\n}\n\n/**\n * Spawn Agent Modal Management\n */\ninterface SpawnModalElements {\n  overlay: HTMLElement | null;\n  closeBtn: HTMLElement | null;\n  cancelBtn: HTMLElement | null;\n  submitBtn: HTMLElement | null;\n  nameInput: HTMLInputElement | null;\n  cliSelect: HTMLSelectElement | null;\n  modelInput: HTMLInputElement | null;\n  taskInput: HTMLTextAreaElement | null;\n}\n\nfunction getSpawnModalElements(): SpawnModalElements {\n  return {\n    overlay: document.getElementById('spawn-modal-overlay'),\n    closeBtn: document.getElementById('spawn-modal-close'),\n    cancelBtn: document.getElementById('spawn-modal-cancel'),\n    submitBtn: document.getElementById('spawn-modal-submit'),\n    nameInput: document.getElementById('spawn-agent-name') as HTMLInputElement,\n    cliSelect: document.getElementById('spawn-agent-cli') as HTMLSelectElement,\n    modelInput: document.getElementById('spawn-agent-model') as HTMLInputElement,\n    taskInput: document.getElementById('spawn-agent-task') as HTMLTextAreaElement,\n  };\n}\n\nfunction openSpawnModal(): void {\n  const modal = getSpawnModalElements();\n  if (modal.overlay) {\n    modal.overlay.classList.add('visible');\n    modal.nameInput?.focus();\n  }\n}\n\nfunction closeSpawnModal(): void {\n  const modal = getSpawnModalElements();\n  if (modal.overlay) {\n    modal.overlay.classList.remove('visible');\n    // Clear form\n    if (modal.nameInput) modal.nameInput.value = '';\n    if (modal.cliSelect) modal.cliSelect.value = 'claude';\n    if (modal.modelInput) modal.modelInput.value = '';\n    if (modal.taskInput) modal.taskInput.value = '';\n  }\n}\n\nasync function handleSpawnAgent(): Promise<void> {\n  const modal = getSpawnModalElements();\n\n  const name = modal.nameInput?.value.trim();\n  const cli = modal.cliSelect?.value;\n  const model = modal.modelInput?.value.trim();\n  const task = modal.taskInput?.value.trim();\n\n  if (!name) {\n    alert('Please enter an agent name');\n    return;\n  }\n\n  if (!cli) {\n    alert('Please select a CLI tool');\n    return;\n  }\n\n  // Disable submit button\n  if (modal.submitBtn) {\n    modal.submitBtn.textContent = 'Spawning...';\n    (modal.submitBtn as HTMLButtonElement).disabled = true;\n  }\n\n  try {\n    const response = await fetch('/api/agent/spawn', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        name,\n        cli,\n        model: model || undefined,\n        task: task || undefined,\n      }),\n    });\n\n    const result = await response.json();\n\n    if (response.ok && result.success) {\n      closeSpawnModal();\n      // Agent will appear in the list when it connects to the relay\n    } else {\n      alert(result.error || 'Failed to spawn agent');\n    }\n  } catch (err) {\n    console.error('Failed to spawn agent:', err);\n    alert('Failed to spawn agent. Check console for details.');\n  } finally {\n    if (modal.submitBtn) {\n      modal.submitBtn.textContent = 'Spawn Agent';\n      (modal.submitBtn as HTMLButtonElement).disabled = false;\n    }\n  }\n}\n\n/**\n * Kill an agent\n */\nasync function killAgent(agentName: string): Promise<void> {\n  if (!confirm(`Are you sure you want to kill agent \"${agentName}\"?`)) {\n    return;\n  }\n\n  try {\n    const response = await fetch('/api/agent/kill', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ name: agentName }),\n    });\n\n    const result = await response.json();\n\n    if (!response.ok) {\n      alert(result.error || 'Failed to kill agent');\n    }\n    // Agent will disappear from the list when it disconnects\n  } catch (err) {\n    console.error('Failed to kill agent:', err);\n    alert('Failed to kill agent. Check console for details.');\n  }\n}\n\n/**\n * Set up spawn modal event listeners\n */\nfunction setupSpawnModalListeners(): void {\n  const modal = getSpawnModalElements();\n\n  // Spawn button in sidebar\n  const spawnBtn = document.getElementById('spawn-agent-btn');\n  if (spawnBtn) {\n    spawnBtn.addEventListener('click', (e) => {\n      e.stopPropagation();\n      openSpawnModal();\n    });\n  }\n\n  // Modal close buttons\n  modal.closeBtn?.addEventListener('click', closeSpawnModal);\n  modal.cancelBtn?.addEventListener('click', closeSpawnModal);\n\n  // Modal submit\n  modal.submitBtn?.addEventListener('click', handleSpawnAgent);\n\n  // Close on overlay click\n  modal.overlay?.addEventListener('click', (e) => {\n    if (e.target === modal.overlay) {\n      closeSpawnModal();\n    }\n  });\n\n  // Close on Escape\n  document.addEventListener('keydown', (e) => {\n    if (e.key === 'Escape' && modal.overlay?.classList.contains('visible')) {\n      closeSpawnModal();\n    }\n  });\n\n  // Enter to submit (when name input is focused)\n  modal.nameInput?.addEventListener('keydown', (e) => {\n    if (e.key === 'Enter') {\n      handleSpawnAgent();\n    }\n  });\n}\n\n/**\n * Attach kill handlers to agent list items\n * Called after agents are rendered\n */\nexport function attachKillHandlers(): void {\n  document.querySelectorAll<HTMLElement>('.agent-kill-btn').forEach((btn) => {\n    btn.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const agentName = btn.dataset.agent;\n      if (agentName) {\n        killAgent(agentName);\n      }\n    });\n  });\n}\n\n// Auto-initialize when DOM is ready\nif (typeof document !== 'undefined') {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n      initApp();\n      setupSpawnModalListeners();\n    });\n  } else {\n    initApp();\n    setupSpawnModalListeners();\n  }\n}\n"],
  "mappings": "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",
  "names": ["subscribe", "listener", "listeners", "index", "notifyListeners", "setAgents", "agents", "state", "setMessages", "messages", "setCurrentChannel", "channel", "setConnectionStatus", "connected", "incrementReconnectAttempts", "setWebSocket", "ws", "getFilteredMessages", "currentChannel", "m", "setCurrentThread", "thread", "getThreadMessages", "threadId", "getThreadReplyCount", "init_state", "__esmMin", "connect", "protocol", "ws", "setConnectionStatus", "delay", "state", "incrementReconnectAttempts", "error", "event", "data", "handleData", "e", "setWebSocket", "a", "setAgents", "setMessages", "dataHandler", "sendMessage", "to", "message", "thread", "body", "response", "result", "init_websocket", "__esmMin", "init_state", "isAgentOnline", "lastSeen", "ts", "escapeHtml", "text", "div", "formatTime", "timestamp", "formatDate", "date", "today", "yesterday", "getAvatarColor", "name", "colors", "hash", "i", "getInitials", "formatMessageBody", "content", "escaped", "init_utils", "__esmMin", "initElements", "elements", "getElements", "updateConnectionStatus", "state", "renderAgents", "a", "html", "agent", "presenceClass", "isAgentOnline", "isActive", "needsAttentionClass", "escapeHtml", "getAvatarColor", "getInitials", "item", "e", "agentName", "selectChannel", "updatePaletteAgents", "attachKillHandlers", "renderMessages", "filtered", "getFilteredMessages", "lastDate", "msg", "msgDate", "formatDate", "isBroadcast", "avatarColor", "replyCount", "getThreadReplyCount", "recipientDisplay", "formatTime", "formatMessageBody", "attachThreadHandlers", "channel", "setCurrentChannel", "prefixEl", "updateOnlineCount", "online", "section", "closeCommandPalette", "initPaletteChannels", "channelName", "openCommandPalette", "paletteSelectedIndex", "filterPaletteResults", "getVisiblePaletteItems", "updatePaletteSelection", "items", "selectedItem", "handlePaletteKeydown", "executePaletteItem", "command", "messageId", "messageEl", "query", "q", "title", "name", "matches", "m", "openThreadPanel", "threadId", "setCurrentThread", "renderThreadMessages", "closeThreadPanel", "messages", "getThreadMessages", "el", "showMentionAutocomplete", "filter", "filterLower", "mentionFilteredAgents", "mentionSelectedIndex", "index", "mention", "completeMention", "hideMentionAutocomplete", "isMentionAutocompleteVisible", "navigateMentionAutocomplete", "direction", "selectedMention", "input", "value", "atMatch", "completedText", "getCurrentMentionQuery", "cursorPos", "init_components", "__esmMin", "init_state", "init_utils", "app_exports", "__export", "attachKillHandlers", "initApp", "detectProjectContext", "match", "setupProjectContext", "projectId", "workspaceName", "response", "project", "nameSpan", "n", "bridgeLinkText", "bridgeNavLink", "elements", "initElements", "fromBridge", "subscribe", "updateConnectionStatus", "renderAgents", "renderMessages", "updateOnlineCount", "setupEventListeners", "connect", "item", "channel", "selectChannel", "handleSend", "isMentionAutocompleteVisible", "completeMention", "navigateMentionAutocomplete", "hideMentionAutocomplete", "query", "getCurrentMentionQuery", "showMentionAutocomplete", "input", "start", "end", "text", "before", "after", "selected", "emojis", "emoji", "openCommandPalette", "closeCommandPalette", "target", "filterPaletteResults", "handlePaletteKeydown", "command", "initPaletteChannels", "closeThreadPanel", "handleThreadSend", "parseMention", "getElements", "rawMessage", "parsed", "to", "message", "result", "sendMessage", "threadId", "state", "renderThreadMessages", "getSpawnModalElements", "openSpawnModal", "modal", "closeSpawnModal", "handleSpawnAgent", "name", "cli", "model", "task", "err", "killAgent", "agentName", "setupSpawnModalListeners", "spawnBtn", "e", "btn", "init_app", "__esmMin", "init_state", "init_websocket", "init_components"]
}
