{"id":"agent-relay-0bn","title":"Dashboard doesn't show real-time connection status","description":"Dashboard shows agent status from messages but doesn't show live connection status (connected/disconnected). The daemon tracks this in agents.json but dashboard could show online/offline indicators with last-seen timestamps.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T00:18:04.647965+01:00","updated_at":"2025-12-20T00:18:04.647965+01:00"}
{"id":"agent-relay-0uh","title":"Add session discovery for better status output","description":"Auto-discover relay sessions via 'tmux list-sessions'. Filter to relay-* sessions and extract agent names. Enhance 'agent-relay status' command output. See docs/TMUX_IMPROVEMENTS.md for implementation details.","status":"closed","priority":2,"issue_type":"feature","assignee":"LeadDev","created_at":"2025-12-20T21:28:49.058578+01:00","updated_at":"2025-12-20T21:36:23.10406+01:00","closed_at":"2025-12-20T21:36:23.10406+01:00"}
{"id":"agent-relay-1ek","title":"Add agent registry for persistence across restarts","description":"Store agent metadata in persistent registry (agents.json): id, name, cli, workingDirectory, firstSeen, lastSeen, messagesSent, messagesReceived. Enables agent history and stats. See docs/TMUX_IMPROVEMENTS.md for implementation details.","notes":"No progress today; agent registry idea remains open. Consider aligning with Swarm Mail 'agents' projection + last_active tracking.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-20T21:28:50.235444+01:00","updated_at":"2025-12-20T22:00:47.791303+01:00"}
{"id":"agent-relay-2lw","title":"Add agent metadata tracking","description":"Track program, model, task description in agents.json. Better agent discovery.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:36:19.741328+01:00","updated_at":"2025-12-20T21:36:19.741328+01:00"}
{"id":"agent-relay-2sn","title":"Competitive Analysis: mcp_agent_mail vs agent-relay","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-20T21:34:44.49366+01:00","updated_at":"2025-12-20T21:36:26.362391+01:00","closed_at":"2025-12-20T21:36:26.362391+01:00"}
{"id":"agent-relay-2uf","title":"Add message threading support","description":"@relay:Bob [thread:feature-123] pattern. Group related messages for better context.","notes":"Current state: thread parsing + protocol/storage support implemented (ParsedCommand.thread, SendPayload.thread, DB messages.thread + filter). Remaining: wire cmd.thread through tmux-wrapper sendRelayCommand -\u003e RelayClient.sendMessage(..., thread) and include thread in injected display/Inbox. See src/wrapper/tmux-wrapper.ts sendRelayCommand + handleIncomingMessage.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:36:19.631448+01:00","updated_at":"2025-12-20T21:59:53.973954+01:00"}
{"id":"agent-relay-2z1","title":"ACK messages not used for reliability","description":"In connection.ts:114-116, ACK messages are accepted but not processed. The protocol supports reliable delivery with ACK/NACK but it's not implemented. Need to: (1) Track unACKed messages, (2) Implement retry logic, (3) Add configurable TTL for messages.","status":"closed","priority":2,"issue_type":"feature","assignee":"LeadDev","created_at":"2025-12-20T00:17:43.615251+01:00","updated_at":"2025-12-20T21:56:07.202292+01:00","closed_at":"2025-12-20T21:56:07.202292+01:00"}
{"id":"agent-relay-37i","title":"Message deduplication uses in-memory Set without limits","description":"In tmux-wrapper.ts:65, sentMessageHashes is a Set that grows unbounded. For long-running sessions, this could cause memory issues. Add: (1) Max size with LRU eviction, (2) Time-based expiration, (3) Bloom filter alternative for memory efficiency.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T00:18:47.229988+01:00","updated_at":"2025-12-20T00:18:47.229988+01:00"}
{"id":"agent-relay-41f","title":"BUG: better-sqlite3 bindings fail on Node 25","description":"agent-relay read command fails with 'Could not locate the bindings file' on Node v25.2.1. Need to rebuild bindings or use compatible Node version.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:46:24.882216+01:00","updated_at":"2025-12-20T21:49:56.89756+01:00","closed_at":"2025-12-20T21:49:56.89756+01:00"}
{"id":"agent-relay-47z","title":"Express 5 may have breaking changes from Express 4 patterns","description":"package.json uses express@5.2.1 which is a major version with breaking changes from Express 4. Verify: (1) Error handling middleware patterns, (2) Router behavior, (3) Body parsing (express.json vs body-parser).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T00:18:49.269841+01:00","updated_at":"2025-12-20T00:18:49.269841+01:00"}
{"id":"agent-relay-4e0","title":"Fix message truncation - messages cut off at source","description":"Root cause found: parser.ts:40 inline regex only captures single line. Multi-line messages are split by parsePassThrough() at line 206. Fix options: (1) Allow continuation lines in inline format, (2) Use block format for multi-line, (3) Add heuristic to join lines until next @relay pattern.","status":"closed","priority":2,"issue_type":"bug","assignee":"MistyShelter","created_at":"2025-12-19T23:40:35.082717+01:00","updated_at":"2025-12-20T00:03:54.806087+01:00","closed_at":"2025-12-20T00:03:54.806087+01:00"}
{"id":"agent-relay-4ft","title":"Merge project info into status command","description":"","status":"closed","priority":2,"issue_type":"task","assignee":"Pruner","created_at":"2025-12-19T21:59:52.685495+01:00","updated_at":"2025-12-19T22:06:44.276187+01:00","closed_at":"2025-12-19T22:06:44.276187+01:00"}
{"id":"agent-relay-51u","title":"Outgoing messages truncated before delivery","description":"Agent messages are being cut off mid-sentence. Examples: 'Updates for mcl/2z1:' and 'Signing off. Progress report:' - both end abruptly. May be related to capture-pane buffer limits, parser issues, or injection timing. Investigate: (1) capture-pane -S - scrollback limits, (2) parser line joining, (3) message storage truncation.","notes":"PROGRESS: Reproduced truncation in tmux wrapper/relay flow. Likely due to display truncation on injection length and terminal capture limitations. No code changes yet.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-20T21:50:11.411952+01:00","updated_at":"2025-12-20T21:58:01.000293+01:00"}
{"id":"agent-relay-52d","title":"Add metrics/observability for daemon","description":"No way to monitor daemon health, message throughput, or agent activity. Add: (1) /metrics endpoint for Prometheus, (2) Message count/rate stats, (3) Connection lifecycle events, (4) Error rate tracking.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T00:18:48.378728+01:00","updated_at":"2025-12-20T00:18:48.378728+01:00"}
{"id":"agent-relay-5af","title":"Hook doesn't integrate with daemon-based messaging","description":"hooks/inbox-check/hook.ts reads from file-based inbox but the daemon uses SQLite. When using daemon mode, the hook won't see messages. Need to: (1) Query daemon storage, (2) Or ensure inbox files are written in daemon mode too.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-20T00:18:35.503078+01:00","updated_at":"2025-12-20T00:18:35.503078+01:00"}
{"id":"agent-relay-5fa","title":"Add exponential backoff for daemon reconnection","description":"Implement graceful reconnection with exponential backoff delays [100, 500, 1000, 2000, 5000ms]. After max attempts, operate offline gracefully. See docs/TMUX_IMPROVEMENTS.md for implementation details.","status":"closed","priority":2,"issue_type":"feature","assignee":"LeadDev","created_at":"2025-12-20T21:28:48.055013+01:00","updated_at":"2025-12-20T21:33:42.229756+01:00","closed_at":"2025-12-20T21:33:42.229756+01:00"}
{"id":"agent-relay-5g0","title":"Heartbeat timeout could be more configurable","description":"In connection.ts:196, heartbeat timeout is hardcoded as 2x heartbeatMs. This should be independently configurable. Also, heartbeat failures immediately kill the connection - could implement exponential backoff for transient issues.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T00:18:03.556614+01:00","updated_at":"2025-12-20T00:18:03.556614+01:00"}
{"id":"agent-relay-68a","title":"Ask pattern: request/response messaging (replyTo + deferred)","description":"Implement an RPC-like ask() over agent-relay: sender creates a short-lived deferred handle, sends message with replyTo, receiver responds resolving the deferred. Similar to swarm-mail DurableDeferred + ask/respond.","acceptance_criteria":"- ask() returns response or times out\\n- Deferreds are persisted with TTL\\n- Works across process restarts/reconnects","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T21:44:33.930531+01:00","updated_at":"2025-12-20T21:44:33.930531+01:00","labels":["coordination","protocol"]}
{"id":"agent-relay-6nx","title":"Add activity state tracking for better injection timing","description":"Track active/idle/disconnected state with timestamps. When session goes idle (30s no activity), trigger message injection opportunity. Improves injection timing vs current fixed 1.5s wait. See docs/TMUX_IMPROVEMENTS.md for implementation details.","status":"closed","priority":2,"issue_type":"feature","assignee":"LeadDev","created_at":"2025-12-20T21:28:46.993856+01:00","updated_at":"2025-12-20T21:33:42.223042+01:00","closed_at":"2025-12-20T21:33:42.223042+01:00"}
{"id":"agent-relay-6ny","title":"Fix message truncation: store full message in SQLite first, include ID in relay","description":"","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-19T22:04:36.168862+01:00","updated_at":"2025-12-19T22:08:28.207532+01:00","closed_at":"2025-12-19T22:08:28.207532+01:00"}
{"id":"agent-relay-6rz","title":"Message injection timing can cause race conditions","description":"In tmux-wrapper.ts:564-569, injection waits for 'idle' (1.5s since last output) but this is fragile. If agent produces output during injection, messages could interleave. Consider: (1) Input buffer detection, (2) Bracketed paste mode, (3) Agent-specific injection strategies.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-20T00:18:17.76865+01:00","updated_at":"2025-12-20T00:18:17.76865+01:00"}
{"id":"agent-relay-7bp","title":"Memory storage adapter has fixed 1000 message limit","description":"In storage/adapter.ts:60-63, MemoryStorageAdapter hard-codes 1000 message limit. This should be configurable and potentially use LRU eviction instead of slice.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T00:17:46.132735+01:00","updated_at":"2025-12-20T00:17:46.132735+01:00"}
{"id":"agent-relay-7tu","title":"Fix storage portability: better-sqlite3 native binding failures","description":"The read command fails in some Node versions (e.g., Node 25) due to missing better-sqlite3 bindings. Decide path: pin supported Node LTS + ensure rebuild, or replace with a non-native option (e.g., Node sqlite, wasm, or a pure JS adapter).","design":"Implement driver selection/fallback: try better-sqlite3, fallback to node:sqlite DatabaseSync when bindings missing. Add env override AGENT_RELAY_SQLITE_DRIVER=node|better-sqlite3. Convert queries to positional params so both drivers share code.","acceptance_criteria":"- dist CLI read works on supported Node versions\\n- CI/build docs reflect supported runtime or replacement adapter","notes":"Implemented sqlite portability: dynamic better-sqlite3 import + fallback to node:sqlite (env override AGENT_RELAY_SQLITE_DRIVER). Updated sqlite adapter to use positional params for compatibility; added/updated tests; npx vitest run passes (216).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T21:44:57.868091+01:00","updated_at":"2025-12-20T21:56:13.384399+01:00","closed_at":"2025-12-20T21:56:13.3844+01:00","labels":["build","storage"]}
{"id":"agent-relay-7yo","title":"Update CLAUDE.md with new CLI commands","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T22:00:02.661859+01:00","updated_at":"2025-12-19T22:07:27.766701+01:00","closed_at":"2025-12-19T22:07:27.766701+01:00","dependencies":[{"issue_id":"agent-relay-7yo","depends_on_id":"agent-relay-85z","type":"blocks","created_at":"2025-12-19T22:00:25.731921+01:00","created_by":"daemon"},{"issue_id":"agent-relay-7yo","depends_on_id":"agent-relay-4ft","type":"blocks","created_at":"2025-12-19T22:00:25.772241+01:00","created_by":"daemon"},{"issue_id":"agent-relay-7yo","depends_on_id":"agent-relay-bd0","type":"blocks","created_at":"2025-12-19T22:00:25.80776+01:00","created_by":"daemon"},{"issue_id":"agent-relay-7yo","depends_on_id":"agent-relay-f3q","type":"blocks","created_at":"2025-12-19T22:00:25.843131+01:00","created_by":"daemon"}]}
{"id":"agent-relay-85z","title":"Merge dashboard into start command","description":"","status":"closed","priority":2,"issue_type":"task","assignee":"InterfaceManager","created_at":"2025-12-19T21:59:51.61716+01:00","updated_at":"2025-12-19T22:06:44.27487+01:00","closed_at":"2025-12-19T22:06:44.27487+01:00"}
{"id":"agent-relay-8ff","title":"Add agent list command to CLI","description":"CLI has up/down/status/read but no way to list connected agents or see message history from command line. Add: (1) agent-relay agents - list connected agents, (2) agent-relay history - show recent messages, (3) agent-relay send \u003cagent\u003e \u003cmsg\u003e - send from CLI.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T00:18:34.400432+01:00","updated_at":"2025-12-20T00:18:34.400432+01:00"}
{"id":"agent-relay-8nx","title":"SIGINT/SIGTERM handlers don't await cleanup","description":"In cli/index.ts:74-77 and daemon setup, SIGINT handlers call stop() but process.exit(0) runs immediately. The stop() is async but not awaited, potentially leaving socket files or incomplete shutdown.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-20T00:18:19.189514+01:00","updated_at":"2025-12-20T00:18:19.189514+01:00"}
{"id":"agent-relay-8z1","title":"Add CLI tests for new command structure","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T22:00:04.561793+01:00","updated_at":"2025-12-20T21:57:43.401385+01:00","dependencies":[{"issue_id":"agent-relay-8z1","depends_on_id":"agent-relay-85z","type":"blocks","created_at":"2025-12-19T22:00:27.632396+01:00","created_by":"daemon"},{"issue_id":"agent-relay-8z1","depends_on_id":"agent-relay-4ft","type":"blocks","created_at":"2025-12-19T22:00:27.671868+01:00","created_by":"daemon"},{"issue_id":"agent-relay-8z1","depends_on_id":"agent-relay-bd0","type":"blocks","created_at":"2025-12-19T22:00:27.713889+01:00","created_by":"daemon"},{"issue_id":"agent-relay-8z1","depends_on_id":"agent-relay-f3q","type":"blocks","created_at":"2025-12-19T22:00:27.752052+01:00","created_by":"daemon"}]}
{"id":"agent-relay-9uy","title":"Durable inbox state (unread/read/acked per recipient)","description":"Implement per-recipient inbox state (unread/read/acked) similar to swarm-mail’s message_recipients projection. Persist and query unread/urgent; expose to dashboard + CLI read/lookup.","acceptance_criteria":"- Can mark message read and acked per recipient\\n- Dashboard/API can query unreadOnly and urgentOnly\\n- State survives daemon restart","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-20T21:43:46.201965+01:00","updated_at":"2025-12-20T21:43:46.201965+01:00","labels":["durability","storage"]}
{"id":"agent-relay-ahe","title":"Session resume not implemented - RESUME_TOO_OLD always sent","description":"In connection.ts:140-143, session resume tokens are received but not persisted or validated. The server always responds with RESUME_TOO_OLD. This breaks the resume capability advertised in the protocol. Need to implement token persistence and session state recovery.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-20T00:17:30.605649+01:00","updated_at":"2025-12-20T00:17:30.605649+01:00"}
{"id":"agent-relay-bd0","title":"Consolidate team-* commands under team subcommand","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T21:59:54.102815+01:00","updated_at":"2025-12-19T22:06:16.220013+01:00","closed_at":"2025-12-19T22:06:16.220013+01:00"}
{"id":"agent-relay-bei","title":"Gemini (CleverBeacon) bash syntax errors - unexpected EOF","description":"Gemini agent gets bash errors: 'unexpected EOF while looking for matching quote' and 'syntax error: unexpected end of file' when running shell commands. Possibly related to quote escaping in the relay wrapper.","status":"closed","priority":2,"issue_type":"bug","assignee":"GraniteElk","created_at":"2025-12-19T23:40:36.464079+01:00","updated_at":"2025-12-19T23:45:46.05609+01:00","closed_at":"2025-12-19T23:45:46.05609+01:00"}
{"id":"agent-relay-cli-simplify","title":"Simplify agent-relay CLI interface","description":"The CLI has too many commands. Consolidate into a clean, simple interface:\n\n1. `relay start` should also kick off the dashboard automatically\n2. Merge redundant team-* commands\n3. Remove rarely-used commands or make them subcommands\n4. Target: 5-7 top-level commands max\n\nCurrent commands to evaluate:\n- start, stop, status (keep)\n- wrap (keep)\n- project (keep or merge into status)\n- send (keep)\n- team-setup, team-status, team-send, team-check, team-listen, team-start (consolidate)\n- msg-read (make subcommand or integrate)\n- dashboard (merge into start)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T22:00:00Z","updated_at":"2025-12-19T22:08:44.107992+01:00","closed_at":"2025-12-19T22:08:44.107992+01:00"}
{"id":"agent-relay-d07","title":"Message metadata: subject/thread/importance/replyTo","description":"Add first-class metadata fields to messages (subject, threadId, importance, ackRequired, replyTo/correlationId). Carry them via SendPayload.data and/or [[RELAY]] blocks; persist in storage; update injection formatting + dashboard filters.","acceptance_criteria":"- Can send/receive messages with threadId + importance\\n- Dashboard can filter/group by threadId\\n- Injection shows importance/thread hint without breaking TUIs","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T21:44:18.094598+01:00","updated_at":"2025-12-20T21:44:18.094598+01:00","labels":["protocol","ux"]}
{"id":"agent-relay-d2f","title":"Add optional Git audit trail","description":"Commit messages to .agent-relay/messages/ directory. Recoverable history, compliance-friendly.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:36:19.689795+01:00","updated_at":"2025-12-20T21:36:19.689795+01:00"}
{"id":"agent-relay-dd8","title":"Add file reservation system (from mcp_agent_mail)","description":"Advisory locks with TTL, @relay:lock pattern, pre-commit hook integration. Critical for multi-agent file editing.","notes":"No progress today; added as future work from swarm-mail comparison: implement reservations/locks with TTL + conflict detection. See swarm-mail reservations + locks patterns.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T21:36:19.573504+01:00","updated_at":"2025-12-20T22:00:37.608017+01:00"}
{"id":"agent-relay-dyr","title":"No authentication between agents","description":"Any process can connect to the daemon socket and impersonate any agent name. Consider: (1) Per-agent tokens/secrets, (2) Socket permission checks, (3) Optional TLS for non-localhost deployments.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T00:18:16.215889+01:00","updated_at":"2025-12-20T00:18:16.215889+01:00"}
{"id":"agent-relay-f3q","title":"Make msg-read a subcommand of send or message","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T21:59:55.123772+01:00","updated_at":"2025-12-19T22:04:51.112763+01:00","closed_at":"2025-12-19T22:04:51.112763+01:00"}
{"id":"agent-relay-fb3","title":"Add configurable relay prefix for Gemini compatibility","description":"Gemini CLI uses @ for file references, conflicting with @relay:. Add --prefix flag to CLI and relayPrefix config option. Auto-detect CLI type and use appropriate default (\u003e\u003e for Gemini, @relay: for Claude/Codex). Update parser to use dynamic prefix. See docs/TMUX_IMPROVEMENTS.md for full implementation plan.","status":"closed","priority":2,"issue_type":"feature","assignee":"Coordinator","created_at":"2025-12-20T21:28:52.685002+01:00","updated_at":"2025-12-20T21:40:13.066766+01:00","closed_at":"2025-12-20T21:40:13.066766+01:00"}
{"id":"agent-relay-ghy","title":"Team config: auto-spawn agents or auto-assign names from teams.json","description":"When a project has a teams.json config file, agent-relay up should either:\n\n1. **Auto-spawn option**: Automatically kick off terminal sessions for each agent defined in teams.json\n2. **Auto-assign option**: When users manually start sessions with `agent-relay -n \u003cname\u003e claude`, validate the name against teams.json and auto-assign roles/permissions\n\n## teams.json format\n```json\n{\n  \"team\": \"my-project\",\n  \"agents\": [\n    {\"name\": \"Coordinator\", \"cli\": \"claude\", \"role\": \"coordinator\"},\n    {\"name\": \"LeadDev\", \"cli\": \"claude\", \"role\": \"developer\"},\n    {\"name\": \"Reviewer\", \"cli\": \"claude\", \"role\": \"reviewer\"}\n  ],\n  \"autoSpawn\": false\n}\n```\n\n## Behavior\n- If `autoSpawn: true`, `agent-relay up` spawns tmux sessions for each agent\n- If `autoSpawn: false`, validate names against config when agents connect\n- Store teams.json in project root or .agent-relay/teams.json\n\n## Commands\n- `agent-relay up --spawn` - force spawn all agents\n- `agent-relay up --no-spawn` - just start daemon, manual agent starts","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-19T23:13:02.482971+01:00","updated_at":"2025-12-20T21:57:43.362401+01:00"}
{"id":"agent-relay-go9","title":"PostgreSQL storage adapter not implemented","description":"In storage/adapter.ts:152-162, PostgreSQL is listed as a storage option but throws 'not yet implemented'. For production multi-node deployments, SQLite won't scale. Implement PostgreSQL adapter for distributed storage.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T00:17:45.065487+01:00","updated_at":"2025-12-20T00:17:45.065487+01:00"}
{"id":"agent-relay-hgd","title":"Reliable delivery: resume/replay via cursor/checkpoint","description":"Make ACK/RESUME real: persist a per-agent delivery cursor (last delivered/acked seq) and on reconnect replay missed messages from storage. Use existing delivery.seq as stream position, similar to swarm-mail DurableCursor checkpointing.","acceptance_criteria":"- Client can reconnect and receive missed messages\\n- Duplicate suppression is deterministic (id/seq based)\\n- Cursor persists across daemon restarts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-20T21:44:02.016428+01:00","updated_at":"2025-12-20T21:44:02.016428+01:00","labels":["durability","protocol"]}
{"id":"agent-relay-hks","title":"Increase test coverage for daemon/server.ts, dashboard, and CLI","description":"Current coverage is only 39% overall. Key files with 0% coverage: daemon/server.ts, dashboard/server.ts, cli/index.ts, wrapper/client.ts, wrapper/tmux-wrapper.ts, utils/project-namespace.ts. Need integration tests for the daemon startup/shutdown lifecycle and CLI commands.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T00:17:29.603137+01:00","updated_at":"2025-12-20T00:17:29.603137+01:00"}
{"id":"agent-relay-j9z","title":"Message injection corrupts human input in progress","description":"When a relay message arrives while the human is actively typing, the injection (Esc + Ctrl-U + message + Enter) destroys their partial input. Need to detect active input state before injecting. Options: (1) Check tmux pane input buffer, (2) Queue messages until prompt detected, (3) Use tmux display-message instead of send-keys for non-intrusive notification, (4) Add visual indicator that message is pending.","design":"Mitigation ideas: 1) Prefer tmux non-intrusive notify: tmux display-message (and always write to inbox/storage) instead of send-keys when user is typing. 2) Gate send-keys injection on 'safe' state: pane idle AND prompt detected AND no partial input; otherwise queue. 3) If queued, show pending count via display-message.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-20T21:48:03.280298+01:00","updated_at":"2025-12-20T22:00:04.196161+01:00","dependencies":[{"issue_id":"agent-relay-j9z","depends_on_id":"agent-relay-6rz","type":"blocks","created_at":"2025-12-20T21:48:10.118963+01:00","created_by":"daemon"}]}
{"id":"agent-relay-kzw","title":"Project namespace uses /tmp which can be cleared on reboot","description":"In utils/project-namespace.ts:13, BASE_DIR is /tmp/agent-relay. On macOS/Linux, /tmp is cleared on reboot, losing all message history. Consider: (1) XDG_DATA_HOME fallback, (2) ~/.agent-relay option, (3) Per-project .agent-relay folder.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T00:18:33.224965+01:00","updated_at":"2025-12-20T00:18:33.224965+01:00"}
{"id":"agent-relay-l99","title":"Add output filtering for cleaner logs","description":"Filter noisy patterns from logs: thinking indicators [1/418], empty ANSI-only lines, etc. Add config.filterLogs option. See docs/TMUX_IMPROVEMENTS.md for implementation details.","status":"open","priority":4,"issue_type":"feature","created_at":"2025-12-20T21:28:51.199736+01:00","updated_at":"2025-12-20T21:28:51.199736+01:00","dependencies":[{"issue_id":"agent-relay-l99","depends_on_id":"agent-relay-1ek","type":"blocks","created_at":"2025-12-20T21:29:26.987526+01:00","created_by":"daemon"}]}
{"id":"agent-relay-mcl","title":"Gemini agent cannot send messages properly","description":"Gemini agent cannot autonomously send relay messages. When Gemini outputs @relay: patterns, it enters shell mode instead of being intercepted by the relay wrapper. Manual typing works fine. This suggests a PTY parsing issue specific to how Gemini outputs the @relay: pattern - possibly timing, escaping, or output buffering differences compared to Claude.","status":"closed","priority":2,"issue_type":"bug","assignee":"LeadDev","created_at":"2025-12-20T00:29:15.797552+01:00","updated_at":"2025-12-20T21:56:07.20143+01:00","closed_at":"2025-12-20T21:56:07.20143+01:00"}
{"id":"agent-relay-oiw","title":"BUG: No per-agent inbox files created","description":"Expected /tmp/agent-relay/\u003cproject\u003e/\u003cagent\u003e/inbox.md but only team/agents.json exists. Agents cannot read their inbox via file.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-20T21:46:24.826442+01:00","updated_at":"2025-12-20T21:46:24.826442+01:00"}
{"id":"agent-relay-sio","title":"Add graceful degradation when relay daemon is unavailable","description":"In wrapper/tmux-wrapper.ts:195-197, daemon connection failures are silently caught. Consider: (1) Periodic reconnection attempts, (2) Queueing messages for later delivery, (3) Visual indicator in terminal showing connection status.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-20T00:17:32.600333+01:00","updated_at":"2025-12-20T00:17:32.600333+01:00"}
{"id":"agent-relay-ucw","title":"Dashboard: multi-project navigation or dynamic port allocation","description":"When the dashboard is already running for one project, users should be able to either: (1) Navigate between different projects in a single dashboard view, OR (2) Start a new dashboard instance on an automatically allocated available port for a different project. Currently if a dashboard is running, starting another project conflicts.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-19T23:40:18.667766+01:00","updated_at":"2025-12-20T00:18:05.10495+01:00","closed_at":"2025-12-20T00:18:05.10495+01:00"}
{"id":"agent-relay-v57","title":"No message expiration/cleanup in SQLite storage","description":"SQLite adapter has no TTL or cleanup mechanism for old messages. Over time, the database will grow unbounded. Add: (1) Configurable message retention period, (2) Automatic cleanup job, (3) Index on ts column is there but no cleanup uses it.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T00:18:01.86766+01:00","updated_at":"2025-12-20T00:18:01.86766+01:00"}
{"id":"fed-003","title":"[Phase 1] Implement PeerManager","description":"Create src/federation/peer-manager.ts. Manages multiple PeerConnection instances. Connect to configured peers on daemon start. Handle peer discovery from WELCOME messages.","status":"open","priority":1,"issue_type":"task","assignee":"Network","depends_on":["fed-002"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-1"]}
{"id":"fed-004","title":"[Phase 1] Add peer WebSocket listener to daemon","description":"Extend daemon to listen for incoming peer connections on configurable port (default 8765). Accept connections, perform handshake, register with PeerManager.","status":"open","priority":1,"issue_type":"task","assignee":"Network","depends_on":["fed-003"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-1"]}
{"id":"fed-005","title":"[Phase 2] Implement FleetRegistry","description":"Create src/federation/registry.ts with FleetRegistry class. Track agents across fleet with agentToServer mapping. Support fleet-wide unique name enforcement with quorum registration. See FEDERATION_PROPOSAL.md Section 5.","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["fed-004"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-2"]}
{"id":"fed-006","title":"[Phase 2] Implement PEER_SYNC message handling","description":"Handle agent_joined, agent_left, full_sync message types. Update FleetRegistry on sync. Trigger sync on new peer connection and periodically (60s).","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["fed-005"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-2"]}
{"id":"fed-007","title":"[Phase 2] Implement name resolution","description":"Add resolve() method to FleetRegistry. Support patterns: Bob (local-first then fleet), Bob@server (explicit), *@server (broadcast to server). See FEDERATION_PROPOSAL.md Section 5.2.","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["fed-006"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-2"]}
{"id":"fed-008","title":"[Phase 2] CLI: agent-relay agents --fleet","description":"Add --fleet flag to agents command. Query FleetRegistry for all agents across servers. Display server, CLI, status, connected_at columns.","status":"open","priority":2,"issue_type":"task","assignee":"CLI","depends_on":["fed-005"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-2","cli"]}
{"id":"fed-009","title":"[Phase 3] Implement PEER_ROUTE handling","description":"Handle incoming PEER_ROUTE messages. Extract target agent, look up in local registry, deliver via existing tmux send-keys injection. Preserve automatic delivery magic.","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["fed-007"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-3"]}
{"id":"fed-010","title":"[Phase 3] Implement PEER_BROADCAST handling","description":"Handle incoming PEER_BROADCAST messages. Deliver to all local agents except excluded. Support scope (fleet vs server).","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["fed-009"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-3"]}
{"id":"fed-015","title":"[Phase 4] Implement heartbeat (PING/PONG)","description":"Send PEER_PING every 30s. Expect PEER_PONG within 60s. Trigger reconnect on timeout. Track latency_ms in ServerRecord.","status":"open","priority":1,"issue_type":"task","assignee":"Network","depends_on":["fed-013"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-4"]}
{"id":"fed-016","title":"[Phase 4] Implement graceful shutdown (PEER_BYE)","description":"Send PEER_BYE on daemon shutdown. Remove agents from fleet registry. Allow queued messages to be sent before disconnect.","status":"open","priority":2,"issue_type":"task","assignee":"Network","depends_on":["fed-015"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-4"]}
{"id":"fed-017","title":"[Phase 4] CLI: agent-relay peer status","description":"Add peer subcommands: list, add, remove, status. Show connection state, latency, agent count, last seen.","status":"open","priority":2,"issue_type":"task","assignee":"CLI","depends_on":["fed-015"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-4","cli"]}
{"id":"fed-020","title":"[Phase 5] Add configuration file support","description":"Parse /etc/agent-relay/config.yaml or ~/.agent-relay/config.yaml. Support all federation settings from FEDERATION_PROPOSAL.md Section 12. Environment variable overrides.","status":"open","priority":1,"issue_type":"task","assignee":"CLI","depends_on":["fed-016"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-5","cli"]}
{"id":"fed-021","title":"[Phase 5] Update dashboard for fleet view","description":"Add fleet view toggle to dashboard. Show agents from all servers with server badge. Show peer connection status. Real-time updates via existing WebSocket.","status":"open","priority":2,"issue_type":"task","assignee":"CLI","depends_on":["fed-008"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-5","dashboard"]}
{"id":"fed-024","title":"[Storage] Implement trajectory storage adapter","description":"Create TrajectoryStorageAdapter interface. File system backend (default). SQLite backend for local queries. See FEDERATION_PROPOSAL.md Section 17 and Trajectories Proposal.","status":"open","priority":2,"issue_type":"task","assignee":"Storage","created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","storage","trajectories"]}
{"id":"fed-025","title":"[Storage] Implement central trajectory sync","description":"PostgreSQL backend for team sharing. Sync on task complete. Conflict resolution (server-wins default). See FEDERATION_PROPOSAL.md Section 17.3.","status":"open","priority":3,"issue_type":"task","assignee":"Storage","depends_on":["fed-024"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","storage","trajectories"]}
{"id":"fed-001","title":"[Phase 1] Define peer protocol types","description":"Create src/protocol/peer-types.ts with PeerMessageType, PeerEnvelope, PeerHelloPayload, PeerWelcomePayload, PeerSyncPayload, PeerRoutePayload, PeerBroadcastPayload. See FEDERATION_PROPOSAL.md Section 4.","status":"open","priority":1,"issue_type":"task","assignee":"Architect","collaborators":["Network"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-1"]}
{"id":"fed-011","title":"[Phase 3] Integrate FederatedRouter with existing Router","description":"Modify existing Router to check FleetRegistry for remote agents. Route to PeerManager for cross-server delivery. Keep local delivery path unchanged.","status":"open","priority":1,"issue_type":"task","assignee":"Router","collaborators":["Network"],"depends_on":["fed-010"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-3"]}
{"id":"fed-012","title":"[Phase 3] Implement loop prevention","description":"Add hops array to PEER_ROUTE messages. Check for loops before forwarding. Drop messages that have already visited this server. Note: Can be implemented as part of fed-009/010.","status":"open","priority":3,"issue_type":"task","assignee":"Router","depends_on":["fed-009"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-3","can-merge"]}
{"id":"fed-014","title":"[Phase 4] Implement message queue for disconnected peers","description":"Create src/federation/message-queue.ts. Bounded queue per peer (max 1000 messages). TTL expiration (1 hour). Flush on reconnect.","status":"open","priority":1,"issue_type":"task","assignee":"Storage","collaborators":["Network"],"depends_on":["fed-004"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-4","storage"]}
{"id":"fed-018","title":"[Phase 5] Add TLS support for peer connections","description":"Configure wss:// with cert/key/ca paths. Support mutual TLS (mTLS) optionally. Reject non-TLS in production mode.","status":"open","priority":1,"issue_type":"task","assignee":"Security","collaborators":["Network"],"depends_on":["fed-016"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-5","security"]}
{"id":"fed-022","title":"[Phase 5] Implement delivery confirmation","description":"Add DELIVERY_CONFIRMED message type. Detect injection via capture-pane. Send confirmation back to sender. Optional sender notification. See FEDERATION_PROPOSAL.md Section 7.","status":"open","priority":2,"issue_type":"task","assignee":"Router","collaborators":["Network"],"depends_on":["fed-011"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-5"]}
{"id":"fed-026a","title":"[Transport] Define PeerTransport interface","description":"Create src/federation/transport.ts with PeerTransport interface: connect(), disconnect(), send(), broadcast(), subscribe(), getConnectedPeers(). WebSocketTransport as default implementation. See FEDERATION_PROPOSAL.md Section 11.2.","status":"open","priority":2,"issue_type":"task","assignee":"Architect","collaborators":["Network"],"depends_on":["fed-023"],"created_at":"2025-12-21T13:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","transport"]}
{"id":"fed-026","title":"[Transport] Implement NATS transport adapter","description":"Create NatsTransport implementing PeerTransport interface. JetStream for persistence. Subject-based routing. See FEDERATION_PROPOSAL.md Section 11.4.","status":"open","priority":3,"issue_type":"task","assignee":"Network","depends_on":["fed-026a"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","nats","optional"]}
{"id":"fed-027","title":"Write federation integration tests","description":"Docker Compose setup for multi-server testing. Test cross-server messaging, reconnection, broadcast. Chaos testing for network partitions.","status":"open","priority":2,"issue_type":"task","assignee":"Architect","collaborators":["Network","Router"],"depends_on":["fed-022"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","testing"]}
{"id":"fed-002","title":"[Phase 1] Implement PeerConnection class","description":"Create src/federation/peer-connection.ts. WebSocket connection to single peer with state machine (DISCONNECTED→CONNECTING→HANDSHAKING→ACTIVE→RECONNECTING). Handle HELLO/WELCOME handshake. See FEDERATION_PROPOSAL.md Section 4.6.","status":"open","priority":1,"issue_type":"task","assignee":"Network","depends_on":["fed-001"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-1"]}
{"id":"fed-013","title":"[Phase 4] Implement reconnection logic","description":"Add exponential backoff reconnection (1s→2s→4s→...→30s max). Unlimited retry attempts for configured peers. Resume session on reconnect.","status":"open","priority":1,"issue_type":"task","assignee":"Network","depends_on":["fed-011"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","phase-4"]}
{"id":"fed-019","title":"[Phase 5] Implement Ed25519 authentication","description":"Generate server keypair on first run. Challenge-response handshake. Sign all peer messages. Verify signatures on receive. See FEDERATION_PROPOSAL.md Section 8.1-8.3.","status":"open","priority":1,"issue_type":"task","assignee":"Security","collaborators":["Architect"],"depends_on":["fed-018"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-5","security"]}
{"id":"fed-023","title":"[Phase 5] Implement flow control","description":"Add credit-based flow control per peer. PEER_ACK to replenish credits. PEER_BUSY/PEER_READY for backpressure. Rate limiting. See FEDERATION_PROPOSAL.md Section 9.","status":"open","priority":2,"issue_type":"task","assignee":"Network","collaborators":["Storage"],"depends_on":["fed-014"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T13:00:00Z","labels":["federation","phase-5"]}
{"id":"fed-028","title":"Write federation documentation","description":"Update README with federation quick start. Document configuration options. Add architecture diagrams. Troubleshooting guide.","status":"open","priority":2,"issue_type":"task","assignee":"Architect","depends_on":["fed-027"],"created_at":"2025-12-21T12:00:00Z","updated_at":"2025-12-21T12:00:00Z","labels":["federation","docs"]}
{"id":"ctrl-001","title":"[Control Plane] Design Control API (REST + WebSocket)","description":"Design API for human control plane: POST /tasks, GET /agents, POST /agents/:id/msg, WS /stream. OpenAPI spec. Authentication endpoints. See ai-maestro's manager/worker pattern for reference.","status":"open","priority":2,"issue_type":"task","assignee":"Architect","collaborators":["CLI"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","api"]}
{"id":"ctrl-002","title":"[Control Plane] Implement Lead Agent orchestration","description":"Lead Agent receives human intent, breaks into tasks, assigns to specialized agents based on skills, monitors progress, escalates decisions. Can be AI-powered or rule-based initially.","status":"open","priority":2,"issue_type":"task","assignee":"Router","collaborators":["Architect"],"depends_on":["ctrl-001","fed-011"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","orchestration"]}
{"id":"ctrl-003","title":"[Control Plane] Build web dashboard v2 (fleet control)","description":"Next.js dashboard with: fleet overview, task assignment UI, agent status cards, trajectory viewer, decision queue. Learn from ai-maestro's hierarchical naming and color coding.","status":"open","priority":2,"issue_type":"task","assignee":"CLI","depends_on":["ctrl-001","fed-021"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","dashboard"]}
{"id":"ctrl-004","title":"[Control Plane] Human authentication (OAuth/magic link)","description":"Secure human access to control plane. OAuth2 (GitHub/Google) or magic link email auth. JWT tokens for API access. Role-based permissions (admin/operator/viewer).","status":"open","priority":2,"issue_type":"task","assignee":"Security","depends_on":["ctrl-001"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","security"]}
{"id":"ctrl-005","title":"[Control Plane] Push notification service","description":"Real-time notifications to mobile/web: APNs for iOS, FCM for Android/web. Notify on: task completion, agent questions, escalations, errors.","status":"open","priority":3,"issue_type":"task","assignee":"Network","depends_on":["ctrl-001"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","notifications"]}
{"id":"ctrl-006","title":"[Control Plane] iPhone app MVP","description":"React Native or Swift app: fleet status view, task list, agent messaging, push notifications, decision queue with quick actions. Minimal viable version.","status":"open","priority":3,"issue_type":"task","assignee":"CLI","collaborators":["Architect"],"depends_on":["ctrl-003","ctrl-005"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","mobile"]}
{"id":"ctrl-007","title":"[Control Plane] Slack/Discord bot integration","description":"Bot for team chat: /fleet status, /assign task agent, @mentions for escalations, threaded replies for agent questions. Webhook-based notifications.","status":"open","priority":3,"issue_type":"task","assignee":"CLI","depends_on":["ctrl-001"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","integrations"]}
{"id":"ctrl-008","title":"[Control Plane] Human escalation queue","description":"Queue for decisions needing human input. Agents can escalate with context. Humans respond via any interface (web/mobile/Slack). Response routed back to agent.","status":"open","priority":2,"issue_type":"task","assignee":"Router","collaborators":["CLI"],"depends_on":["ctrl-002"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","escalation"]}
{"id":"ctrl-009","title":"[Control Plane] Agent skills registry","description":"Track agent capabilities: skills map (Network→websocket,tcp,tls), availability, current workload, performance history. Used by Lead Agent for smart assignment.","status":"open","priority":2,"issue_type":"task","assignee":"Router","depends_on":["fed-005"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","registry"]}
{"id":"ctrl-010","title":"[Control Plane] Code Graph integration","description":"Learn from ai-maestro: visualize codebase as graph (classes, functions, relationships). Delta indexing for performance. Shared context for all agents. Multi-language support.","status":"open","priority":3,"issue_type":"task","assignee":"Storage","collaborators":["Architect"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","intelligence"]}
{"id":"ctrl-011","title":"[Control Plane] Agent health monitoring","description":"Like ai-maestro's green/red/yellow status: heartbeat checks, resource usage, error rates, stuck detection. Alert on degradation. Auto-recovery actions.","status":"open","priority":2,"issue_type":"task","assignee":"Network","depends_on":["fed-015"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","monitoring"]}
{"id":"ctrl-012","title":"[Control Plane] Agent portability (export/import)","description":"Learn from ai-maestro: export agent as .zip with config, message history, git associations, skills. Import with conflict detection. Enable agent migration between fleets.","status":"open","priority":3,"issue_type":"task","assignee":"Storage","depends_on":["fed-024"],"created_at":"2025-12-21T14:00:00Z","updated_at":"2025-12-21T14:00:00Z","labels":["control-plane","portability"]}
{"id":"mem-001","title":"[Memory] Integrate Mem0 as memory substrate","description":"Add Mem0 dependency to agent-trajectories. Implement MemoryBackend interface wrapping Mem0 SDK. Support both self-hosted and cloud Mem0. See MEMORY_STACK_DECISION.md for architecture.","status":"open","priority":1,"issue_type":"task","assignee":"Storage","created_at":"2025-12-21T15:00:00Z","updated_at":"2025-12-21T15:00:00Z","labels":["memory","mem0","agent-trajectories"]}
{"id":"mem-002","title":"[Memory] Configure Mem0 MCP for Claude Code agents","description":"Add MCP configuration for Mem0 integration with Claude Code. Document setup in agent-relay README. Test memory persistence across sessions.","status":"open","priority":2,"issue_type":"task","assignee":"CLI","depends_on":["mem-001"],"created_at":"2025-12-21T15:00:00Z","updated_at":"2025-12-21T15:00:00Z","labels":["memory","mcp","claude-code"]}
{"id":"mem-003","title":"[Memory] Build task-based trajectory layer on Mem0","description":"Implement trajectory grouping on top of Mem0 observations. Map task_id to Mem0 user_id or metadata. Support chapter-based organization within trajectories.","status":"open","priority":1,"issue_type":"task","assignee":"Storage","collaborators":["Architect"],"depends_on":["mem-001"],"created_at":"2025-12-21T15:00:00Z","updated_at":"2025-12-21T15:00:00Z","labels":["memory","trajectories","agent-trajectories"]}
{"id":"mem-004","title":"[Memory] Implement fleet-wide knowledge workspace","description":"Build knowledge workspace layer: decisions log, pattern library, cross-agent context. Query interface for agents to access fleet knowledge. Uses Mem0 for storage.","status":"open","priority":2,"issue_type":"task","assignee":"Storage","collaborators":["Router"],"depends_on":["mem-003"],"created_at":"2025-12-21T15:00:00Z","updated_at":"2025-12-21T15:00:00Z","labels":["memory","knowledge","agent-trajectories"]}
{"id":"mem-005","title":"[Memory] Abstract MemoryBackend for future flexibility","description":"Create MemoryBackend interface allowing swap between Mem0, Zep, or custom SQLite+Chroma. Default to Mem0. Enable migration path if needs change.","status":"open","priority":3,"issue_type":"task","assignee":"Architect","depends_on":["mem-001"],"created_at":"2025-12-21T15:00:00Z","updated_at":"2025-12-21T15:00:00Z","labels":["memory","architecture","agent-trajectories"]}
{"id":"hook-001","title":"[Hooks] Implement pattern namespace registry","description":"Create src/hooks/pattern-registry.ts. Register pattern handlers by namespace (@relay:, @memory:, @custom:). Match output against patterns. Route to handlers. Support built-in and user-defined namespaces. See HOOKS_API.md.","status":"open","priority":1,"issue_type":"task","assignee":"Router","created_at":"2025-12-21T16:00:00Z","updated_at":"2025-12-21T16:00:00Z","labels":["hooks","core"]}
{"id":"hook-002","title":"[Hooks] Implement hook lifecycle events","description":"Add lifecycle events to tmux wrapper: onSessionStart, onSessionEnd, onOutput, onIdle, onMessageReceived. Emit events with HookContext. Allow handlers to inject text. See HOOKS_API.md.","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["hook-001"],"created_at":"2025-12-21T16:00:00Z","updated_at":"2025-12-21T16:00:00Z","labels":["hooks","core"]}
{"id":"hook-003","title":"[Hooks] Implement @memory: built-in handler","description":"Create built-in @memory: pattern handler. Support actions: save, search, forget, list. Connect to Mem0 backend. Inject results back to agent. See HOOKS_API.md and MEMORY_STACK_DECISION.md.","status":"open","priority":1,"issue_type":"task","assignee":"Storage","collaborators":["Router"],"depends_on":["hook-001","mem-001"],"created_at":"2025-12-21T16:00:00Z","updated_at":"2025-12-21T16:00:00Z","labels":["hooks","memory"]}
{"id":"hook-004","title":"[Hooks] Implement relay.config.ts loader","description":"Create config loader for relay.config.ts. Support project root and ~/.config/agent-relay/. Load pattern handlers and lifecycle hooks. Type-safe config with RelayConfig interface. See HOOKS_API.md.","status":"open","priority":2,"issue_type":"task","assignee":"CLI","depends_on":["hook-002"],"created_at":"2025-12-21T16:00:00Z","updated_at":"2025-12-21T16:00:00Z","labels":["hooks","config"]}
{"id":"hook-005","title":"[Hooks] Programmatic hook API","description":"Export Relay class with pattern() and on() methods. Allow programmatic registration of handlers. TypeScript types for HookContext, PatternHandler. See HOOKS_API.md.","status":"open","priority":2,"issue_type":"task","assignee":"Architect","collaborators":["Router"],"depends_on":["hook-002"],"created_at":"2025-12-21T16:00:00Z","updated_at":"2025-12-21T16:00:00Z","labels":["hooks","api"]}
{"id":"hook-006","title":"[Hooks] Document hooks API with examples","description":"Write hooks documentation: pattern syntax, lifecycle events, config file format, programmatic API. Include examples for @memory:, @notify:, @deploy: patterns. Update README.","status":"open","priority":3,"issue_type":"task","assignee":"Architect","depends_on":["hook-005"],"created_at":"2025-12-21T16:00:00Z","updated_at":"2025-12-21T16:00:00Z","labels":["hooks","docs"]}
{"id":"hook-007","title":"[Hooks] Create HookEmitter class","description":"Create src/hooks/emitter.ts with HookEmitter class. Support on(event, handler), emit(event, ...args). Handle async handlers. Support stop propagation. Load handlers from config object. See HOOKS_API.md.","status":"open","priority":1,"issue_type":"task","assignee":"Router","created_at":"2025-12-21T17:00:00Z","updated_at":"2025-12-21T17:00:00Z","labels":["hooks","core"]}
{"id":"hook-008","title":"[Hooks] Implement onSessionStart event","description":"Add onSessionStart hook to TmuxWrapper.start(). Fire after tmux spawn, before polling. Pass HookContext with agentId, sessionId, workingDir. Inject returned text. See HOOKS_API.md lifecycle spec.","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["hook-007"],"created_at":"2025-12-21T17:00:00Z","updated_at":"2025-12-21T17:00:00Z","labels":["hooks","lifecycle"]}
{"id":"hook-009","title":"[Hooks] Implement onSessionEnd event","description":"Add onSessionEnd hook to TmuxWrapper.stop() and SIGINT handler. Fire before cleanup. Inject returned text and wait for agent response (5s timeout). See HOOKS_API.md lifecycle spec.","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["hook-007"],"created_at":"2025-12-21T17:00:00Z","updated_at":"2025-12-21T17:00:00Z","labels":["hooks","lifecycle"]}
{"id":"hook-010","title":"[Hooks] Implement onOutput event","description":"Add onOutput hook to TmuxWrapper.pollOutput(). Fire on new output diff. Pass output string and context. Keep handlers fast (warn if >100ms). See HOOKS_API.md lifecycle spec.","status":"open","priority":2,"issue_type":"task","assignee":"Router","depends_on":["hook-007"],"created_at":"2025-12-21T17:00:00Z","updated_at":"2025-12-21T17:00:00Z","labels":["hooks","lifecycle"]}
{"id":"hook-011","title":"[Hooks] Implement onIdle event","description":"Add onIdle hook to TmuxWrapper.pollOutput(). Fire when no output for idleThreshold (default 30s). Fire once per idle period, not continuously. Configurable threshold. See HOOKS_API.md lifecycle spec.","status":"open","priority":2,"issue_type":"task","assignee":"Router","depends_on":["hook-007"],"created_at":"2025-12-21T17:00:00Z","updated_at":"2025-12-21T17:00:00Z","labels":["hooks","lifecycle"]}
{"id":"hook-012","title":"[Hooks] Implement onMessageReceived event","description":"Add onMessageReceived hook to TmuxWrapper.handleIncomingMessage(). Fire before injection. Allow suppress or custom inject. Pass RelayMessage and context. See HOOKS_API.md lifecycle spec.","status":"open","priority":1,"issue_type":"task","assignee":"Router","depends_on":["hook-007"],"created_at":"2025-12-21T17:00:00Z","updated_at":"2025-12-21T17:00:00Z","labels":["hooks","lifecycle"]}
{"id":"hook-013","title":"[Hooks] Define HookContext and HookResult types","description":"Create src/hooks/types.ts with HookContext interface (agentId, sessionId, workingDir, env, inject(), send(), memory, relay, output[], messages[]). Define HookResult (inject?, suppress?, stop?). See HOOKS_API.md.","status":"open","priority":1,"issue_type":"task","assignee":"Architect","created_at":"2025-12-21T17:00:00Z","updated_at":"2025-12-21T17:00:00Z","labels":["hooks","types"]}
